<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The pages explain the transactions by using samples recorded or adapted from transactions performed during the annual Swiss projectathon (September 2020)."><meta name=author content="eHealth Suisse"><link href=https://ehealthsuisse.github.io/EPR-by-example/Atna/ rel=canonical><link href=../ProvideXAssertion/ rel=prev><link href=../playground/ rel=next><link rel=icon href=../media/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.4.14"><title>Audit logs - EPR by example</title><link rel=stylesheet href=../assets/stylesheets/main.fad675c6.min.css><link rel=stylesheet href=../assets/stylesheets/palette.356b1318.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../media/ehealthsuisse.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=custom> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#audit-logs class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=https://www.e-health-suisse.ch/ title="EPR by example" class="md-header__button md-logo" aria-label="EPR by example" data-md-component=logo> <img src=../media/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> EPR by example </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Audit logs </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://www.e-health-suisse.ch/ title="EPR by example" class="md-nav__button md-logo" aria-label="EPR by example" data-md-component=logo> <img src=../media/logo.svg alt=logo> </a> EPR by example </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Patient Management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Patient Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../PDQ/ class=md-nav__link> <span class=md-ellipsis> Patient Demographics Query </span> </a> </li> <li class=md-nav__item> <a href=../PIXFeed/ class=md-nav__link> <span class=md-ellipsis> PIX Feed </span> </a> </li> <li class=md-nav__item> <a href=../PIXQuery/ class=md-nav__link> <span class=md-ellipsis> PIX Query </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Document Management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Document Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../RegistryStoredQuery/ class=md-nav__link> <span class=md-ellipsis> Registry Stored Query </span> </a> </li> <li class=md-nav__item> <a href=../RetrieveDocumentSet/ class=md-nav__link> <span class=md-ellipsis> Retrieve Document Set </span> </a> </li> <li class=md-nav__item> <a href=../ProvideAndRegister/ class=md-nav__link> <span class=md-ellipsis> Provide and Register Document Set </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Authentication </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Authentication </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../AuthenticateUser/ class=md-nav__link> <span class=md-ellipsis> Authenticate User </span> </a> </li> <li class=md-nav__item> <a href=../IdPRenew/ class=md-nav__link> <span class=md-ellipsis> IdP Renew </span> </a> </li> <li class=md-nav__item> <a href=../SSOLogout/ class=md-nav__link> <span class=md-ellipsis> SSO Logout </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex> <span class=md-ellipsis> Authorization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Authorization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../GetXAssertion/ class=md-nav__link> <span class=md-ellipsis> Get X-User Assertion </span> </a> </li> <li class=md-nav__item> <a href=../ProvideXAssertion/ class=md-nav__link> <span class=md-ellipsis> Provide X-User Assertion </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex> <span class=md-ellipsis> Audit </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Audit </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Audit logs </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Audit logs </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#specifications class=md-nav__link> <span class=md-ellipsis> Specifications </span> </a> </li> <li class=md-nav__item> <a href=#basic-structure class=md-nav__link> <span class=md-ellipsis> Basic structure </span> </a> </li> <li class=md-nav__item> <a href=#requirements-for-transactions-secured-by-xua class=md-nav__link> <span class=md-ellipsis> Requirements for transactions secured by XUA </span> </a> </li> <li class=md-nav__item> <a href=#special-parts class=md-nav__link> <span class=md-ellipsis> Special parts </span> </a> <nav class=md-nav aria-label="Special parts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#query class=md-nav__link> <span class=md-ellipsis> Query </span> </a> </li> <li class=md-nav__item> <a href=#patient class=md-nav__link> <span class=md-ellipsis> Patient </span> </a> </li> <li class=md-nav__item> <a href=#submission-set class=md-nav__link> <span class=md-ellipsis> Submission set </span> </a> </li> <li class=md-nav__item> <a href=#document class=md-nav__link> <span class=md-ellipsis> Document </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#requirements-summary class=md-nav__link> <span class=md-ellipsis> Requirements summary </span> </a> </li> <li class=md-nav__item> <a href=#sending-an-audit-log class=md-nav__link> <span class=md-ellipsis> Sending an audit log </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> Public Test Systems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Public Test Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../playground/ class=md-nav__link> <span class=md-ellipsis> EPR Playground </span> </a> </li> <li class=md-nav__item> <a href=../gazelle/ class=md-nav__link> <span class=md-ellipsis> EPR Reference Environment </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex> <span class=md-ellipsis> Swiss EPR Exchange Formats </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Swiss EPR Exchange Formats </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../MedicationCardDocument/ class=md-nav__link> <span class=md-ellipsis> Medication Card document </span> </a> </li> <li class=md-nav__item> <a href=../ImmunizationAdministrationDocument/ class=md-nav__link> <span class=md-ellipsis> Immunization Administration Document </span> </a> </li> <li class=md-nav__item> <a href=../Questionnaire/ class=md-nav__link> <span class=md-ellipsis> How to build a FHIR-Questionnaire </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#specifications class=md-nav__link> <span class=md-ellipsis> Specifications </span> </a> </li> <li class=md-nav__item> <a href=#basic-structure class=md-nav__link> <span class=md-ellipsis> Basic structure </span> </a> </li> <li class=md-nav__item> <a href=#requirements-for-transactions-secured-by-xua class=md-nav__link> <span class=md-ellipsis> Requirements for transactions secured by XUA </span> </a> </li> <li class=md-nav__item> <a href=#special-parts class=md-nav__link> <span class=md-ellipsis> Special parts </span> </a> <nav class=md-nav aria-label="Special parts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#query class=md-nav__link> <span class=md-ellipsis> Query </span> </a> </li> <li class=md-nav__item> <a href=#patient class=md-nav__link> <span class=md-ellipsis> Patient </span> </a> </li> <li class=md-nav__item> <a href=#submission-set class=md-nav__link> <span class=md-ellipsis> Submission set </span> </a> </li> <li class=md-nav__item> <a href=#document class=md-nav__link> <span class=md-ellipsis> Document </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#requirements-summary class=md-nav__link> <span class=md-ellipsis> Requirements summary </span> </a> </li> <li class=md-nav__item> <a href=#sending-an-audit-log class=md-nav__link> <span class=md-ellipsis> Sending an audit log </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=audit-logs>Audit logs<a class=headerlink href=#audit-logs title="Permanent link"> ¶</a></h1> <p>When executing most of the transactions with the <abbr title="Electronic Patient Record">EPR</abbr>, there is a requirement to send an audit log to the community describing who did what and when, on the client's side. The community also creates such an audit log, and both can be compared if the need arises.</p> <p>Since the audit logs may contain information about the transaction outcome, you have to wait for the community response before creating the audit log.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>You have to do your best efforts to send the audit logs, even if the transaction has failed (network issue or error 500 for example).</p> </div> <h2 id=specifications>Specifications<a class=headerlink href=#specifications title="Permanent link"> ¶</a></h2> <p>The base specification of the <code class=highlight><span class=nt>&lt;AuditMessage&gt;</span></code> format is given in <a href=https://dicom.nema.org/medical/dicom/current/output/html/part15.html rel="external nofollow noopener" target=_blank>DICOM PS3.15</a>. Additional requirements are described in:</p> <ul> <li>For each transaction, in the 'Security Considerations' section of each transaction profile;</li> <li>In the <a href=https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html rel="external nofollow noopener" target=_blank>IHE Audit Trail and Node Authentication (<abbr title="Audit Trail and Node Authentication">ATNA</abbr>) Profile</a>;</li> <li>In <a href=https://profiles.ihe.net/ITI/TF/Volume2/ITI-20.html rel="external nofollow noopener" target=_blank>IHE ITI-20</a>;</li> <li>In <a href=https://profiles.ihe.net/ITI/TF/Volume2/ITI-40.html#3.40.4.2 rel="external nofollow noopener" target=_blank>IHE ITI-40</a> §3.40.4.2;</li> <li>In the <a href=https://www.fedlex.admin.ch/eli/oc/2024/194/de/annexes rel="external nofollow noopener" target=_blank>Amendment 1 to Annex 5</a>, §1.5 and §1.6.4.3.5.1;</li> </ul> <h2 id=basic-structure>Basic structure<a class=headerlink href=#basic-structure title="Permanent link"> ¶</a></h2> <p>An audit log is simply wrapped in a <code class=highlight><span class=nt>&lt;AuditMessage&gt;</span></code> element. No namespace is needed.</p> <p>The first child is a <em>EventIdentification</em> element that describes the transaction: <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nt>&lt;EventIdentification</span><span class=w> </span><span class=na>EventActionCode=</span><span class=s>&quot;★action_code&quot;</span><span class=w> </span><span class=na>EventDateTime=</span><span class=s>&quot;★date_time&quot;</span><span class=w> </span><span class=na>EventOutcomeIndicator=</span><span class=s>&quot;★outcome&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>  </span><span class=nt>&lt;EventID</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;★transaction_code&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;DCM&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;★transaction_display&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>  </span><span class=nt>&lt;EventTypeCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;★type_code&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;IHE Transactions&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;★type_display&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>  </span><span class=nt>&lt;PurposeOfUse</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;★puo_code&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;2.16.756.5.30.1.127.3.10.5&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;★puo_display&quot;</span><span class=w> </span><span class=nt>/&gt;</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=nt>&lt;/EventIdentification&gt;</span>
</code></pre></div> where:</p> <ul> <li><code>action_code</code>, <code>transaction_code</code>, <code>transaction_display</code>,<code>type_code</code> and <code>type_display</code> depend on the transaction type and are defined in the IHE transaction profile, in the 'Security Considerations' section;</li> <li><code>date_time</code> is the date and time at which the transaction was made. It shall contain a timezone, and shall follow the <a href=https://www.w3.org/TR/xmlschema11-2/#dateTime rel="external nofollow noopener" target=_blank>xsd:dateTime</a> format;</li> <li><code>outcome</code> describes whether the transaction was successful or not: <code>0</code> is a success, <code>4</code> is a minor failure, <code>8</code> is a serious failure and <code>12</code> is a major failure. The choice of the failure type is left to the implementers;</li> <li><code>puo_code</code> and <code>puo_display</code> are the <em>Purpose of Use</em> code and display name, respectively. It is mandatory when the transaction is secured by <abbr title="X-User Assertion">XUA</abbr>; otherwise, the whole <code class=highlight><span class=nt>&lt;PurposeOfUse&gt;</span></code> element shall be omitted.</li> </ul> <p>Then, two <em>ActiveParticipants</em> describe the source and destination participants.</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1><em>ActiveParticipant</em> source</label><label for=__tabbed_1_2><em>ActiveParticipant</em> destination</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>The first <em>ActiveParticipant</em> describes the source participant, which often is the one that has sent the transaction (but not always). It has the following content: <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nt>&lt;ActiveParticipant</span><span class=w> </span><span class=na>UserID=</span><span class=s>&quot;★user_id&quot;</span><span class=w> </span><span class=na>AlternativeUserID=</span><span class=s>&quot;★alt_user_id&quot;</span><span class=w> </span><span class=na>NetworkAccessPointID=</span><span class=s>&quot;★nap_id&quot;</span><span class=w> </span><span class=na>NetworkAccessPointTypeCode=</span><span class=s>&quot;★nap_type&quot;</span><span class=w> </span><span class=na>UserIsRequest=</span><span class=s>&quot;true&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>  </span><span class=nt>&lt;RoleIDCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;110153&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;DCM&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Source Role ID&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=nt>&lt;/ActiveParticipant&gt;</span>
</code></pre></div> where:</p> <ul> <li><code>user_id</code> is required and can be filled as you want. It can be a process ID, a login name, or other identifiers;</li> <li><code>alt_user_id</code> is the process ID as used within the local operating system in the local system logs;</li> <li><code>nap_id</code> is the DNS name or IP address of the source;</li> <li><code>nap_type</code> is <code>1</code> for machine (DNS) name, <code>2</code> for IP address.</li> </ul> <p>Other attributes are optional.</p> </div> <div class=tabbed-block> <p>The second <em>ActiveParticipant</em> describes the destination participant, which often is the one that has received the transaction (but not always). It has the following content: <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nt>&lt;ActiveParticipant</span><span class=w> </span><span class=na>UserID=</span><span class=s>&quot;★user_id&quot;</span><span class=w> </span><span class=na>NetworkAccessPointID=</span><span class=s>&quot;★nap_id&quot;</span><span class=w> </span><span class=na>NetworkAccessPointTypeCode=</span><span class=s>&quot;★nap_type&quot;</span><span class=w> </span><span class=na>UserIsRequest=</span><span class=s>&quot;false&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>  </span><span class=nt>&lt;RoleIDCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;110152&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;DCM&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Destination Role ID&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=nt>&lt;/ActiveParticipant&gt;</span>
</code></pre></div> where:</p> <ul> <li><code>user_id</code> is the SOAP endpoint URI;</li> <li><code>nap_id</code> is the DNS name or IP address of the destination;</li> <li><code>nap_type</code> is <code>1</code> for machine (DNS) name, <code>2</code> for IP address.</li> </ul> <p>Other attributes are optional.</p> </div> </div> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>In some transactions such as ITI-43, the source and destination participants are reversed. Always check the IHE specifications for the correct order. The participant "server" is the one having the "SOAP endpoint URI", the participant "client" is the one having the "process ID".</p> </div> <p>Following that is the <code class=highlight><span class=nt>&lt;AuditSourceIdentification&gt;</span></code> element. It contains the following: <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nt>&lt;AuditSourceIdentification</span><span class=w> </span><span class=na>AuditSourceID=</span><span class=s>&quot;★source&quot;</span><span class=w> </span><span class=na>AuditEnterpriseSiteID=</span><span class=s>&quot;★oid&quot;</span><span class=w> </span><span class=nt>/&gt;</span>
</code></pre></div> where <code>oid</code> is required by the <a href=https://www.fedlex.admin.ch/eli/oc/2024/194/de/annexes rel="external nofollow noopener" target=_blank>Amendment 1 to Annex 5</a> (§1.5.2) and must be an OID of your OID hierarchy. Please ask your community if it has requirements about the use of this OID. The <code>source</code> value is required by the standard, but its value choice is left to the implementers; it should contain an "<em>Identifier of the source</em>". You can copy the <code>oid</code> value if you want.</p> <h2 id=requirements-for-transactions-secured-by-xua>Requirements for transactions secured by <abbr title="X-User Assertion">XUA</abbr><a class=headerlink href=#requirements-for-transactions-secured-by-xua title="Permanent link"> ¶</a></h2> <p>If the transaction is secured by <abbr title="X-User Assertion">XUA</abbr> (like ITI-18, ITI-41, ITI-43), then additional <em>ActiveParticipants</em> shall be specified to describe the authenticated participant of the transaction.</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:3><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><input id=__tabbed_2_3 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>First <em>ActiveParticipant</em></label><label for=__tabbed_2_2>Second <em>ActiveParticipant</em></label><label for=__tabbed_2_3>Third <em>ActiveParticipant</em></label></div> <div class=tabbed-content> <div class=tabbed-block> <p>The <strong>first additional <em>ActiveParticipant</em></strong> is described in <a href=https://profiles.ihe.net/ITI/TF/Volume2/ITI-40.html#3.40.4.2 rel="external nofollow noopener" target=_blank>IHE ITI-40</a>, §3.40.4.2. It is required for all roles. It shall contain: <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=nt>&lt;ActiveParticipant</span><span class=w> </span><span class=na>UserID=</span><span class=s>&quot;★user_id&quot;</span><span class=w> </span><span class=na>UserName=</span><span class=s>&quot;★alias&amp;lt;★user@★issuer&amp;gt;&quot;</span><span class=w> </span><span class=na>UserIsRequest=</span><span class=s>&quot;false&quot;</span><span class=w> </span><span class=nt>/&gt;</span>
</code></pre></div> where:</p> <ul> <li><code>user_id</code> is required and can be filled as you want. It can be a process ID, a login name, or other identifiers;</li> <li><code>alias</code> (optional) is the SAML Assertion's <code class=highlight><span class=nc>Subject</span><span class=o>/</span><span class=nc>NameID</span><span class=o>/</span>@<span class=nc>SPProvidedID</span></code> attribute;</li> <li><code>user</code> (required) is the SAML Assertion's <code class=highlight><span class=nc>Subject</span><span class=o>/</span><span class=nc>NameID</span></code> content;</li> <li><code>issuer</code> (required) is the SAML Assertion's <code class=highlight><span class=nc>Issuer</span></code> content.</li> </ul> <p>The other attributes and subject role specification are optional.</p> </div> <div class=tabbed-block> <p>The <strong>second additional <em>ActiveParticipant</em></strong> is described in the <a href=https://www.fedlex.admin.ch/eli/oc/2024/194/de/annexes rel="external nofollow noopener" target=_blank>Amendment 1 to Annex 5</a>, §1.6.4.3.5.1. It is required for all roles. It shall contain: <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nt>&lt;ActiveParticipant</span><span class=w> </span><span class=na>UserID=</span><span class=s>&quot;★user_id&quot;</span><span class=w> </span><span class=na>UserName=</span><span class=s>&quot;★user_name&quot;</span><span class=w> </span><span class=na>UserIsRequestor=</span><span class=s>&quot;false&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>    </span><span class=nt>&lt;RoleIDCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;★code&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;2.16.756.5.30.1.127.3.10.6&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;★display&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=nt>&lt;/ActiveParticipant&gt;</span>
</code></pre></div> where:</p> <ul> <li><code>user_id</code> (required) is the SAML Assertion's <code class=highlight><span class=nc>Subject</span><span class=o>/</span><span class=nc>NameID</span></code> content;</li> <li><code>user_name</code> (required) is the SAML Assertion's <code class=highlight><span class=nc>AttributeStatement</span><span class=o>/</span><span class=nc>Attribute</span><span class=p>[</span>@<span class=nc>Name</span><span class=o>=</span><span class=l>&quot;urn:oasis:names:tc:xspa:1.0:subject:subject-id&quot;</span><span class=p>]</span><span class=o>/</span><span class=nc>AttributeValue</span></code> content;</li> <li><code>code</code> (required) is the SAML Assertion's <code class=highlight><span class=nc>AttributeStatement</span><span class=o>/</span><span class=nc>Attribute</span><span class=p>[</span>@<span class=nc>Name</span><span class=o>=</span><span class=l>&quot;urn:oasis:names:tc:xacml:2.0:subject:role&quot;</span><span class=p>]</span><span class=o>/</span><span class=nc>AttributeValue</span><span class=o>/</span><span class=nc>Role</span><span class=o>/</span>@<span class=nc>code</span></code> attribute.</li> </ul> <p>Other attributes are optional.</p> </div> <div class=tabbed-block> <p>The <strong>third additional <em>ActiveParticipant</em></strong> is described in the <a href=https://www.fedlex.admin.ch/eli/oc/2024/194/de/annexes rel="external nofollow noopener" target=_blank>Amendment 1 to Annex 5</a>, §1.6.4.3.5.1. It is only required for assistants and technical users. It shall contain: <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=nt>&lt;ActiveParticipant</span><span class=w> </span><span class=na>UserID=</span><span class=s>&quot;★user_id&quot;</span><span class=w> </span><span class=na>UserName=</span><span class=s>&quot;★user_name&quot;</span><span class=w> </span><span class=na>UserIsRequest=</span><span class=s>&quot;false&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>    </span><span class=nt>&lt;RoleIDCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;★code&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;2.16.756.5.30.1.127.3.10.6&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;★display&quot;</span><span class=w> </span><span class=nt>/&gt;</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=nt>&lt;/ActiveParticipant&gt;</span>
</code></pre></div> where:</p> <ul> <li><code>user_id</code> (required) is the SAML Assertion's <code class=highlight><span class=nc>Subject</span><span class=o>/</span><span class=nc>SubjectConfirmation</span><span class=o>/</span><span class=nc>NameID</span></code> content;</li> <li><code>user_name</code> (required) is the SAML Assertion's <code class=highlight><span class=nc>Subject</span><span class=o>/</span><span class=nc>SubjectConfirmation</span><span class=o>/</span><span class=nc>SubjectConfirmationData</span><span class=o>/</span><span class=nc>AttributeStatement</span><span class=o>/</span><span class=nc>Attribute</span><span class=p>[</span>@<span class=nc>Name</span><span class=o>=</span><span class=l>&quot;urn:oasis:names:tc:xspa:1.0:subject:subject-id&quot;</span><span class=p>]</span><span class=o>/</span><span class=nc>AttributeValue</span></code> content;</li> <li><code>code</code> (required) is either <code>TCU</code> or <code>ASS</code>.</li> </ul> </div> </div> </div> <h2 id=special-parts>Special parts<a class=headerlink href=#special-parts title="Permanent link"> ¶</a></h2> <p>Some <em>ParticipantObjectIdentification</em> elements may be used to include additional details about the query content.</p> <h3 id=query>Query<a class=headerlink href=#query title="Permanent link"> ¶</a></h3> <p>For ITI-18 transaction, the query content has to be included in the <code class=highlight><span class=nt>&lt;ParticipantObjectIdentification&gt;</span></code> element: <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=nt>&lt;ParticipantObjectIdentification</span><span class=w> </span><span class=na>ParticipantObjectID=</span><span class=s>&quot;★participant_object_id&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCode=</span><span class=s>&quot;2&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCodeRole=</span><span class=s>&quot;24&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectIDTypeCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;★transaction_code&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;IHE Transactions&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;★transaction_display&quot;</span><span class=w> </span><span class=nt>/&gt;</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectQuery&gt;</span>★query_b64<span class=nt>&lt;/ParticipantObjectQuery&gt;</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectDetail</span><span class=w> </span><span class=na>type=</span><span class=s>&quot;QueryEncoding&quot;</span><span class=w> </span><span class=na>value=</span><span class=s>&quot;★query_encoding_b64&quot;</span><span class=w> </span><span class=nt>/&gt;</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=nt>&lt;/ParticipantObjectIdentification&gt;</span>
</code></pre></div> where:</p> <ul> <li><code>participant_object_id</code> is the Stored Query ID for ITI-18, or optional for ITI-45 and ITI-47;</li> <li><code>transaction_code</code> and <code>transaction_display</code> are the same as in <code class=highlight><span class=nc>EventIdentification</span><span class=o>/</span><span class=nc>EventID</span></code>;</li> <li><code>query_b64</code> is the XML representation of a part of the query, base64-encoded:<ul> <li>For ITI-18, the <code>AdhocQueryRequest</code>;</li> <li>For ITI-45 and ITI-47, the <code>QueryByParameter</code> segment of the query;</li> </ul> </li> <li><code>query_encoding_b64</code> is the query encoding, encoded in base64. Usually <code>VVRGLTg=</code> (UTF-8).</li> </ul> <p>For ITI-18 transactions, an additional <code class=highlight><span class=nt>&lt;ParticipantObjectIdentification&gt;</span></code> is required inside, if the homeCommunityID is specified in the query: <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=nt>&lt;ParticipantObjectDetail</span><span class=w> </span><span class=na>type=</span><span class=s>&quot;urn:ihe:iti:xca:2010:homeCommunityId&quot;</span><span class=w> </span><span class=na>value=</span><span class=s>&quot;★home_community_id_b64&quot;</span><span class=w> </span><span class=nt>/&gt;</span>
</code></pre></div> where <code>home_community_id_b64</code> is the value of the homeCommunityId, base64-encoded.</p> <h3 id=patient>Patient<a class=headerlink href=#patient title="Permanent link"> ¶</a></h3> <p><div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=nt>&lt;ParticipantObjectIdentification</span><span class=w> </span><span class=na>ParticipantObjectID=</span><span class=s>&quot;★patient_id&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCode=</span><span class=s>&quot;1&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCodeRole=</span><span class=s>&quot;1&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectIDTypeCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;2&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;RFC-3881&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Patient Number&quot;</span><span class=w> </span><span class=nt>/&gt;</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=nt>&lt;/ParticipantObjectIdentification&gt;</span>
</code></pre></div> where <code>patient_id</code> is the patient identifier encoded in HL7 CX format (e.g. <code>value^^^&amp;1.2.3&amp;ISO</code>).</p> <h3 id=submission-set>Submission set<a class=headerlink href=#submission-set title="Permanent link"> ¶</a></h3> <p>For ITI-41 requests, a <code class=highlight><span class=nt>&lt;ParticipantObjectIdentification&gt;</span></code> is required to describe the Submission Set: <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=nt>&lt;ParticipantObjectIdentification</span><span class=w> </span><span class=na>ParticipantObjectID=</span><span class=s>&quot;★submission_set_unique_id&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCode=</span><span class=s>&quot;2&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCodeRole=</span><span class=s>&quot;20&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectIDTypeCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;urn:uuid:a54d6aa5-d40d-43f9-88c5-b4633d873bdd&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;submission set classificationNode&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;IHE XDS Metadata&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=nt>&lt;/ParticipantObjectIdentification&gt;</span>
</code></pre></div> where <code>submission_set_unique_id</code> is the URN-encoded Submission Set unique ID.</p> <h3 id=document>Document<a class=headerlink href=#document title="Permanent link"> ¶</a></h3> <p>For ITI-43 transactions, a <code class=highlight><span class=nt>&lt;ParticipantObjectIdentification&gt;</span></code> is required to describe the document to be retrieved: <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=nt>&lt;ParticipantObjectIdentification</span><span class=w> </span><span class=na>ParticipantObjectID=</span><span class=s>&quot;★document_unique_id&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCode=</span><span class=s>&quot;2&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCodeRole=</span><span class=s>&quot;3&quot;</span><span class=w> </span><span class=na>ParticipantObjectSensitivity=</span><span class=s>&quot;★confidentiality_code&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectIDTypeCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;9&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;RFC-3881&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Report Number&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectDetail</span><span class=w> </span><span class=na>type=</span><span class=s>&quot;Repository Unique Id&quot;</span><span class=w> </span><span class=na>value=</span><span class=s>&quot;★repo_unique_id_b64&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=nt>&lt;/ParticipantObjectIdentification&gt;</span>
</code></pre></div> where:</p> <ul> <li><code>document_unique_id</code> is the document unique ID;</li> <li><code>repo_unique_id_b64</code> is the repository unique ID;</li> <li><code>confidentiality_code</code> is the document confidentiality code, if known. The format is HL7v2 CE with the code system OID as the code (e.g.: <code>1051000195109^normal^2.16.840.1.113883.6.96</code>).</li> </ul> <p>If the home community ID is known, another <em>ParticipantObjectDetail</em> is required inside: <code class=highlight><span class=nt>&lt;ParticipantObjectDetail</span><span class=w> </span><span class=na>type=</span><span class=s>&quot;ihe:homeCommunityID&quot;</span><span class=w> </span><span class=na>value=</span><span class=s>&quot;★home_community_id_b64&quot;</span><span class=nt>/&gt;</span></code>. The value must be base64-encoded.</p> <h2 id=requirements-summary>Requirements summary<a class=headerlink href=#requirements-summary title="Permanent link"> ¶</a></h2> <table> <thead> <tr> <th></th> <th></th> <th colspan=3>ActiveParticipant</th> <th colspan=4>ParticipantObjectIdentification</th> </tr> <tr> <th>Transaction</th> <th>EventIdentification</th> <th>Source</th> <th>Destination</th> <th>XUA</th> <th>Query</th> <th>Patient</th> <th>Submission Set</th> <th>Document</th> </tr> </thead> <tbody> <tr><td>ITI-18</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>❌</td><td>❌</td></tr> <tr><td>ITI-41</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>❌</td><td>✅</td><td>✅</td><td>❌</td></tr> <tr><td>ITI-43</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>❌</td><td>✅</td><td>❌</td><td>✅</td></tr> <tr><td>ITI-44</td><td>✅</td><td>✅</td><td>✅</td><td>❌</td><td>❌</td><td>✅</td><td>❌</td><td>❌</td></tr> <tr><td>ITI-45</td><td>✅</td><td>✅</td><td>✅</td><td>❌</td><td>✅</td><td>✅</td><td>❌</td><td>❌</td></tr> <tr><td>ITI-47</td><td>✅</td><td>✅</td><td>✅</td><td>❌</td><td>✅</td><td>✅</td><td>❌</td><td>❌</td></tr> <tr><td>ITI-57</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>❌</td><td>✅</td><td>✅</td><td>❌</td></tr> </tbody> </table> <h2 id=sending-an-audit-log>Sending an audit log<a class=headerlink href=#sending-an-audit-log title="Permanent link"> ¶</a></h2> <p>The audit log shall be sent to the community as a syslog message either over TCP (with <abbr title="Transport Layer Security">TLS</abbr>). The relevant specifications are:</p> <ul> <li><a href=https://tools.ietf.org/html/rfc5424 rel="external nofollow noopener" target=_blank>RFC 5424</a>: <em>The Syslog Protocol</em> for information about the syslog message format;</li> <li><a href=https://tools.ietf.org/html/rfc5425 rel="external nofollow noopener" target=_blank>RFC 5425</a>: <em>Transport Layer Security (<abbr title="Transport Layer Security">TLS</abbr>) Transport Mapping for Syslog</em> which formalizes sending Syslog messages over TCP;</li> </ul> <p>The choice of values in the Syslog headers is left to the implementers.</p> <p>An example of a Syslog message sent over TCP is: <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>2027 &lt;85&gt;1 2024-06-25T13:47:57.600Z mag-cara-695f6f7f49-zsxxw IPF 1 IHE+RFC-3881 - ﻿&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;AuditMessage&gt;&lt;EventIdentification EventActionCode=&quot;E&quot; EventDateTime=&quot;2024-06-25T13:47:57.598829760Z&quot; EventOutcomeIndicator=&quot;12&quot;&gt;&lt;EventID csd-code=&quot;110112&quot; codeSystemName=&quot;DCM&quot; originalText=&quot;Query&quot; /&gt;&lt;EventTypeCode csd-code=&quot;ITI-67&quot; codeSystemName=&quot;IHE Transactions&quot; originalText=&quot;Mobile Document Reference Query&quot; /&gt;&lt;/EventIdentification&gt;&lt;ActiveParticipant UserID=&quot;/mag-cara/fhir/DocumentReference&quot; UserIsRequestor=&quot;true&quot; NetworkAccessPointID=&quot;147.87.210.77&quot; NetworkAccessPointTypeCode=&quot;2&quot;&gt;&lt;RoleIDCode csd-code=&quot;110153&quot; codeSystemName=&quot;DCM&quot; originalText=&quot;Source Role ID&quot; /&gt;&lt;/ActiveParticipant&gt;&lt;ActiveParticipant UserID=&quot;https://test.ahdis.ch/mag-cara/fhir/DocumentReference&quot; AlternativeUserID=&quot;1&quot; UserIsRequestor=&quot;false&quot; NetworkAccessPointID=&quot;10.28.2.28&quot; NetworkAccessPointTypeCode=&quot;2&quot;&gt;&lt;RoleIDCode csd-code=&quot;110152&quot; codeSystemName=&quot;DCM&quot; originalText=&quot;Destination Role ID&quot; /&gt;&lt;/ActiveParticipant&gt;&lt;AuditSourceIdentification AuditEnterpriseSiteID=&quot;1.3.6.1.4.1.21367.2017.2.7.109&quot; AuditSourceID=&quot;IPF&quot;&gt;&lt;AuditSourceTypeCode csd-code=&quot;9&quot; codeSystemName=&quot;DCM&quot; originalText=&quot;Other&quot; /&gt;&lt;/AuditSourceIdentification&gt;&lt;ParticipantObjectIdentification ParticipantObjectID=&quot;urn:oid:1.1.1.99.1|215503a0-11d2-4197-822a-053791ab5a8e&quot; ParticipantObjectTypeCode=&quot;1&quot; ParticipantObjectTypeCodeRole=&quot;1&quot;&gt;&lt;ParticipantObjectIDTypeCode csd-code=&quot;2&quot; codeSystemName=&quot;RFC-3881&quot; originalText=&quot;Patient Number&quot; /&gt;&lt;/ParticipantObjectIdentification&gt;&lt;ParticipantObjectIdentification ParticipantObjectID=&quot;MobileDocumentReferenceQuery&quot; ParticipantObjectTypeCode=&quot;2&quot; ParticipantObjectTypeCodeRole=&quot;24&quot;&gt;&lt;ParticipantObjectIDTypeCode csd-code=&quot;ITI-67&quot; codeSystemName=&quot;IHE Transactions&quot; originalText=&quot;Mobile Document Reference Query&quot; /&gt;&lt;ParticipantObjectQuery&gt;c3RhdHVzPWN1cnJlbnQmcGF0aWVudC5pZGVudGlmaWVyPXVybjpvaWQ6MS4xLjEuOTkuMXwyMTU1MDNhMC0xMWQyLTQxOTctODIyYS0wNTM3OTFhYjVhOGU=&lt;/ParticipantObjectQuery&gt;&lt;/ParticipantObjectIdentification&gt;&lt;/AuditMessage&gt;
</code></pre></div></p> <div class="admonition info"> <p class=admonition-title>Note</p> <p>Notice the UTF-8 BOM at the beginning of the payload (just before <code>&lt;?xml</code>). It is required by the syslog protocol for UTF-8 messages. 2027 is the number of bytes in the following message (2025 characters + 2 extra bytes for the BOM).</p> </div> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2025-01-27T09:58:37+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-01-27</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> <a href=https://www.e-health-suisse.ch/ >eHealth Suisse</a> | <a href=https://github.com/ehealthsuisse/EPR-by-example/blob/main/LICENSE><em>Creative Commons Zero v1.0 Universal</em></a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.copy", "search.suggest", "search.highlight", "navigation.sections", "navigation.expand", "toc.follow"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.cd18aaf1.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> </body> </html>