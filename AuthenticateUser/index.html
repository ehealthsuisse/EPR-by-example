<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The pages explain the transactions by using samples recorded or adapted from transactions performed during the annual Swiss projectathon (September 2020)."><meta name=author content="eHealth Suisse"><link href=https://ehealthsuisse.github.io/EPR-by-example/AuthenticateUser/ rel=canonical><link href=../ProvideAndRegister/ rel=prev><link href=../IdPRenew/ rel=next><link rel=icon href=../media/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.4.14"><title>Authenticate User - EPR by example</title><link rel=stylesheet href=../assets/stylesheets/main.fad675c6.min.css><link rel=stylesheet href=../assets/stylesheets/palette.356b1318.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../media/ehealthsuisse.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=custom> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#authenticate-user class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=https://www.e-health-suisse.ch/ title="EPR by example" class="md-header__button md-logo" aria-label="EPR by example" data-md-component=logo> <img src=../media/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> EPR by example </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Authenticate User </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://www.e-health-suisse.ch/ title="EPR by example" class="md-nav__button md-logo" aria-label="EPR by example" data-md-component=logo> <img src=../media/logo.svg alt=logo> </a> EPR by example </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Patient Management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Patient Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../PDQ/ class=md-nav__link> <span class=md-ellipsis> Patient Demographics Query </span> </a> </li> <li class=md-nav__item> <a href=../PIXFeed/ class=md-nav__link> <span class=md-ellipsis> PIX Feed </span> </a> </li> <li class=md-nav__item> <a href=../PIXQuery/ class=md-nav__link> <span class=md-ellipsis> PIX Query </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Document Management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Document Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../RegistryStoredQuery/ class=md-nav__link> <span class=md-ellipsis> Registry Stored Query </span> </a> </li> <li class=md-nav__item> <a href=../RetrieveDocumentSet/ class=md-nav__link> <span class=md-ellipsis> Retrieve Document Set </span> </a> </li> <li class=md-nav__item> <a href=../ProvideAndRegister/ class=md-nav__link> <span class=md-ellipsis> Provide and Register Document Set </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Authentication </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Authentication </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Authenticate User </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Authenticate User </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#transactions class=md-nav__link> <span class=md-ellipsis> Transactions </span> </a> <nav class=md-nav aria-label=Transactions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#authentication-request class=md-nav__link> <span class=md-ellipsis> Authentication Request </span> </a> <nav class=md-nav aria-label="Authentication Request"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#message-semantics class=md-nav__link> <span class=md-ellipsis> Message Semantics </span> </a> <nav class=md-nav aria-label="Message Semantics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#request-message class=md-nav__link> <span class=md-ellipsis> Request Message </span> </a> </li> <li class=md-nav__item> <a href=#response-message class=md-nav__link> <span class=md-ellipsis> Response Message </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transport-protocol class=md-nav__link> <span class=md-ellipsis> Transport Protocol </span> </a> </li> <li class=md-nav__item> <a href=#security-requirements class=md-nav__link> <span class=md-ellipsis> Security Requirements </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#artifact-resolve class=md-nav__link> <span class=md-ellipsis> Artifact Resolve </span> </a> <nav class=md-nav aria-label="Artifact Resolve"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#message-semantics_1 class=md-nav__link> <span class=md-ellipsis> Message Semantics </span> </a> <nav class=md-nav aria-label="Message Semantics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#request-message_1 class=md-nav__link> <span class=md-ellipsis> Request Message </span> </a> </li> <li class=md-nav__item> <a href=#response-message_1 class=md-nav__link> <span class=md-ellipsis> Response Message </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transport-protocol_1 class=md-nav__link> <span class=md-ellipsis> Transport Protocol </span> </a> </li> <li class=md-nav__item> <a href=#security-requirements_1 class=md-nav__link> <span class=md-ellipsis> Security Requirements </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#audit-log class=md-nav__link> <span class=md-ellipsis> Audit Log </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#test-opportunity class=md-nav__link> <span class=md-ellipsis> Test Opportunity </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../IdPRenew/ class=md-nav__link> <span class=md-ellipsis> IdP Renew </span> </a> </li> <li class=md-nav__item> <a href=../SSOLogout/ class=md-nav__link> <span class=md-ellipsis> SSO Logout </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex> <span class=md-ellipsis> Authorization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Authorization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../GetXAssertion/ class=md-nav__link> <span class=md-ellipsis> Get X-User Assertion </span> </a> </li> <li class=md-nav__item> <a href=../ProvideXAssertion/ class=md-nav__link> <span class=md-ellipsis> Provide X-User Assertion </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex> <span class=md-ellipsis> Audit </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Audit </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Atna/ class=md-nav__link> <span class=md-ellipsis> Audit logs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> Public Test Systems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Public Test Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../playground/ class=md-nav__link> <span class=md-ellipsis> EPR Playground </span> </a> </li> <li class=md-nav__item> <a href=../gazelle/ class=md-nav__link> <span class=md-ellipsis> EPR Reference Environment </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex> <span class=md-ellipsis> Swiss EPR Exchange Formats </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Swiss EPR Exchange Formats </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../MedicationCardDocument/ class=md-nav__link> <span class=md-ellipsis> Medication Card document </span> </a> </li> <li class=md-nav__item> <a href=../ImmunizationAdministrationDocument/ class=md-nav__link> <span class=md-ellipsis> Immunization Administration Document </span> </a> </li> <li class=md-nav__item> <a href=../Questionnaire/ class=md-nav__link> <span class=md-ellipsis> How to build a FHIR-Questionnaire </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#transactions class=md-nav__link> <span class=md-ellipsis> Transactions </span> </a> <nav class=md-nav aria-label=Transactions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#authentication-request class=md-nav__link> <span class=md-ellipsis> Authentication Request </span> </a> <nav class=md-nav aria-label="Authentication Request"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#message-semantics class=md-nav__link> <span class=md-ellipsis> Message Semantics </span> </a> <nav class=md-nav aria-label="Message Semantics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#request-message class=md-nav__link> <span class=md-ellipsis> Request Message </span> </a> </li> <li class=md-nav__item> <a href=#response-message class=md-nav__link> <span class=md-ellipsis> Response Message </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transport-protocol class=md-nav__link> <span class=md-ellipsis> Transport Protocol </span> </a> </li> <li class=md-nav__item> <a href=#security-requirements class=md-nav__link> <span class=md-ellipsis> Security Requirements </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#artifact-resolve class=md-nav__link> <span class=md-ellipsis> Artifact Resolve </span> </a> <nav class=md-nav aria-label="Artifact Resolve"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#message-semantics_1 class=md-nav__link> <span class=md-ellipsis> Message Semantics </span> </a> <nav class=md-nav aria-label="Message Semantics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#request-message_1 class=md-nav__link> <span class=md-ellipsis> Request Message </span> </a> </li> <li class=md-nav__item> <a href=#response-message_1 class=md-nav__link> <span class=md-ellipsis> Response Message </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transport-protocol_1 class=md-nav__link> <span class=md-ellipsis> Transport Protocol </span> </a> </li> <li class=md-nav__item> <a href=#security-requirements_1 class=md-nav__link> <span class=md-ellipsis> Security Requirements </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#audit-log class=md-nav__link> <span class=md-ellipsis> Audit Log </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#test-opportunity class=md-nav__link> <span class=md-ellipsis> Test Opportunity </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=authenticate-user>Authenticate User<a class=headerlink href=#authenticate-user title="Permanent link"> ¶</a></h1> <p>Transaction to authenticate a user at a identity provider certified for the Swiss <abbr title="Electronic Patient Record">EPR</abbr>. Primary systems shall use this transaction to retrieve a <abbr title="Identity Provider">IdP</abbr> assertion. The <abbr title="Identity Provider">IdP</abbr> assertion is required to retrieve the <abbr title="X-User Assertion">XUA</abbr> Assertion to be used with <abbr title="Electronic Patient Record">EPR</abbr> transactions.</p> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link"> ¶</a></h2> <p>Primary systems shall use this transaction to retrieve an <abbr title="Identity Provider">IdP</abbr> assertion authentication the user for the access to the Swiss <abbr title="Electronic Patient Record">EPR</abbr>.</p> <p>The requirements for the transaction are defined in <a href=https://www.fedlex.admin.ch/eli/oc/2024/194/de/annexes rel="external nofollow noopener" target=_blank>Annex 8</a> of the ordinances of the Swiss <abbr title="Electronic Patient Record">EPR</abbr>.</p> <p>The <abbr title="Electronic Patient Record">EPR</abbr> requires primary systems to implement authentication as described in the SAML 2.0 specification family, i.e.,</p> <ul> <li><a href=http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf rel="external nofollow noopener" target=_blank>Assertions and Protocols for the OASIS Security Assertion Markup Language (SAML) V2.0</a>.</li> <li><a href=http://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf rel="external nofollow noopener" target=_blank>Bindings for the OASIS Security Assertion Markup Language (SAML) V2.0</a>.</li> <li><a href=http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf rel="external nofollow noopener" target=_blank>Profiles for the OASIS Security Assertion Markup Language (SAML) V2.0</a>.</li> </ul> <p>Primary systems do need implement all the bindings and profiles supported by the SAML 2.0 specification family.</p> <p>In the Swiss <abbr title="Electronic Patient Record">EPR</abbr> the following bindings are required:</p> <ul> <li>HTTP POST Binding.</li> <li>HTTP Artifact Binding.</li> <li>SAML SOAP Binding. </li> </ul> <p>In the Swiss <abbr title="Electronic Patient Record">EPR</abbr> the following profiles are required:</p> <ul> <li>Web Browser SSO Profile.</li> <li>Single Logout Profile.</li> </ul> <p>The usage of the profiles and binding used to authenticate user for the Swiss <abbr title="Electronic Patient Record">EPR</abbr> is described in the following sections.</p> <h2 id=transactions>Transactions<a class=headerlink href=#transactions title="Permanent link"> ¶</a></h2> <p>The transaction to authenticate a user for the access to the Swiss <abbr title="Electronic Patient Record">EPR</abbr> is a multi-step flow consisting of HTTP Post and SOAP Web Service calls, as displayed in the following figure:</p> <p><img alt="Authentication Sequence" src=../media/SAML-Artifact-flow.png></p> <p><strong>Figure 1: Authentication Sequence Diagram</strong></p> <p>The sequence consists of the following steps, each using assigned transaction messages:</p> <ul> <li>[01 .. 04] The user (claimant) is redirected to the identity provider via the user agent (browser) with a SAML 2.0 <em>AuthnRequest</em> message.</li> <li>[05] The user (claimant) authenticates at the identity provider with her authentication means.</li> <li>[06 .. 07] The identity provider responds a SAML 2.0 artifact in a HTTP redirect to the primary system (relying party). </li> <li>[08] The primary system sends a <em>ArtifactResolve</em> message to resolve the SAML artifact to the SAML 2 <abbr title="Identity Provider">IdP</abbr> Assertion via the SOAP backchannel.</li> <li>[09] The <abbr title="Identity Provider">IdP</abbr> responds the <abbr title="Identity Provider">IdP</abbr> Assertion in the <em>ArtifactResponse</em> message.</li> </ul> <h3 id=authentication-request>Authentication Request<a class=headerlink href=#authentication-request title="Permanent link"> ¶</a></h3> <p>The transaction shall be performed by the primary system when the user aims to access the <abbr title="Electronic Patient Record">EPR</abbr>. The primary system shall redirect the user agent (browser) to the <abbr title="Identity Provider">IdP</abbr> authentication endpoint with a <em>AuthnRequest</em> message as defined in <a href=http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf rel="external nofollow noopener" target=_blank>Assertions and Protocols for the OASIS Security Assertion Markup Language (SAML) V2.0</a>.</p> <p>When the user is authenticated by the <abbr title="Identity Provider">IdP</abbr>, the <abbr title="Identity Provider">IdP</abbr> responds with a HTTP redirect to the registered endpoint of the primary system as specified in <a href=http://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf rel="external nofollow noopener" target=_blank>Bindings for the OASIS Security Assertion Markup Language (SAML) V2.0</a>.</p> <h4 id=message-semantics>Message Semantics<a class=headerlink href=#message-semantics title="Permanent link"> ¶</a></h4> <h5 id=request-message>Request Message<a class=headerlink href=#request-message title="Permanent link"> ¶</a></h5> <p>The following snippet is taken from a sample request recorded during the <abbr title="Electronic Patient Record">EPR</abbr> projectathon in September 2020. Some elements were ommitted to increase readability. The raw request file may be found <a href=https://github.com/ehealthsuisse/EPR-by-example/tree/main/Auth_samples/04_AuthnRequest_raw.xml rel="external nofollow noopener" target=_blank>here</a>.</p> <p>The <em>AuthnRequest</em> conveys the following information to be set by the primary system:</p> <ul> <li><em>ID</em>: A unique ID of the request message (line 7 in the example below).</li> <li><em>Issuer</em>: A ID of the primary system as URL (line 9 in the example below).</li> <li><em>SignedInfo</em>: Signature metadata and the digest value used for the signature.</li> <li><em>SignatureValue</em>: The signature of the request (line 23 in the example below).</li> <li><em>X509Certificate</em>: The X509 certificate used to sign the request (line 26 in the example below).</li> </ul> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>04_AuthnRequest.xml</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1> 1</a></span>
<span class=normal><a href=#__codelineno-0-2> 2</a></span>
<span class=normal><a href=#__codelineno-0-3> 3</a></span>
<span class=normal><a href=#__codelineno-0-4> 4</a></span>
<span class=normal><a href=#__codelineno-0-5> 5</a></span>
<span class=normal><a href=#__codelineno-0-6> 6</a></span>
<span class=normal><a href=#__codelineno-0-7> 7</a></span>
<span class=normal><a href=#__codelineno-0-8> 8</a></span>
<span class=normal><a href=#__codelineno-0-9> 9</a></span>
<span class=normal><a href=#__codelineno-0-10>10</a></span>
<span class=normal><a href=#__codelineno-0-11>11</a></span>
<span class=normal><a href=#__codelineno-0-12>12</a></span>
<span class=normal><a href=#__codelineno-0-13>13</a></span>
<span class=normal><a href=#__codelineno-0-14>14</a></span>
<span class=normal><a href=#__codelineno-0-15>15</a></span>
<span class=normal><a href=#__codelineno-0-16>16</a></span>
<span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span>
<span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nt>&lt;AuthnRequest</span>
<a id=__codelineno-0-2 name=__codelineno-0-2></a><span class=w> </span><span class=na>xmlns=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;</span>
<a id=__codelineno-0-3 name=__codelineno-0-3></a><span class=w> </span><span class=na>AssertionConsumerServiceURL=</span><span class=s>&quot;https://epdtest.mycompany.local:8549/ACS&quot;</span>
<a id=__codelineno-0-4 name=__codelineno-0-4></a><span class=w> </span><span class=na>IssueInstant=</span><span class=s>&quot;2020-09-24T13:19:25.208+02:00&quot;</span>
<a id=__codelineno-0-5 name=__codelineno-0-5></a><span class=w> </span><span class=na>Destination=</span><span class=s>&quot;https://fed.idp.ch:443/saml/3.0/idp/&quot;</span>
<a id=__codelineno-0-6 name=__codelineno-0-6></a><span class=w> </span><span class=na>ProtocolBinding=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact&quot;</span>
<a id=__codelineno-0-7 name=__codelineno-0-7></a><span class=hll><span class=w> </span><span class=na>ID=</span><span class=s>&quot;SAML-CD88202A-FE57-11EA-800A-ACB5C93CFFF0&quot;</span>
</span><a id=__codelineno-0-8 name=__codelineno-0-8></a><span class=w> </span><span class=na>Version=</span><span class=s>&quot;2.0&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-0-9 name=__codelineno-0-9></a><span class=hll><span class=w> </span><span class=nt>&lt;Issuer</span><span class=w> </span><span class=na>xmlns=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;</span><span class=nt>&gt;</span>https://epdtest.mycompany.local<span class=nt>&lt;/Issuer&gt;</span>
</span><a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=w> </span><span class=nt>&lt;Signature</span><span class=w> </span><span class=na>xmlns=</span><span class=s>&quot;http://www.w3.org/2000/09/xmldsig#&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=w>  </span><span class=nt>&lt;SignedInfo&gt;</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a><span class=w>   </span><span class=nt>&lt;CanonicalizationMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-0-13 name=__codelineno-0-13></a><span class=w>   </span><span class=nt>&lt;SignatureMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=w>   </span><span class=nt>&lt;Reference</span><span class=w> </span><span class=na>URI=</span><span class=s>&quot;#SAML-CD88202A-FE57-11EA-800A-ACB5C93CFFF0&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=w>    </span><span class=nt>&lt;Transforms&gt;</span>
<a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=w>     </span><span class=nt>&lt;Transform</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=w>     </span><span class=nt>&lt;Transform</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=w>    </span><span class=nt>&lt;/Transforms&gt;</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=w>    </span><span class=nt>&lt;DigestMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=w>    </span><span class=nt>&lt;DigestValue&gt;</span>TdN8cZ5mvY7pOsrpOK0h+YlnvlhOOHYecaBN59yH4w0=<span class=nt>&lt;/DigestValue&gt;</span>
<a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=w>   </span><span class=nt>&lt;/Reference&gt;</span>
<a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=w>  </span><span class=nt>&lt;/SignedInfo&gt;</span>
<a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=hll><span class=w>  </span><span class=nt>&lt;SignatureValue&gt;</span><span class=cm>&lt;!-- omitted for brevity --&gt;</span><span class=nt>&lt;/SignatureValue&gt;</span>
</span><a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=w>  </span><span class=nt>&lt;KeyInfo&gt;</span>
<a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=w>   </span><span class=nt>&lt;X509Data&gt;</span>
<a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=hll><span class=w>    </span><span class=nt>&lt;X509Certificate&gt;</span><span class=cm>&lt;!-- omitted for brevity --&gt;</span><span class=nt>&lt;/X509Certificate&gt;</span>
</span><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=w>   </span><span class=nt>&lt;/X509Data&gt;</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=w>  </span><span class=nt>&lt;/KeyInfo&gt;</span>
<a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=w> </span><span class=nt>&lt;/Signature&gt;</span>
<a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=w> </span><span class=nt>&lt;NameIDPolicy</span><span class=w> </span><span class=na>Format=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;</span><span class=w> </span><span class=na>AllowCreate=</span><span class=s>&quot;true&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=nt>&lt;/AuthnRequest&gt;</span>
</code></pre></div></td></tr></table></div> <h5 id=response-message>Response Message<a class=headerlink href=#response-message title="Permanent link"> ¶</a></h5> <p>The following snippet is taken from a sample request recorded during the <abbr title="Electronic Patient Record">EPR</abbr> projectathon in September 2020. It conveys two parameter to be used by the primary system:</p> <ul> <li><em>SAMLart</em>: The SAML artifact to be used in the <em>ArtifactResolve</em> request (see section below).</li> <li><em>RelayState</em>: A unique identifier of the conversation, the primary system initially sent with the Authentication Request.</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nt>https://epdtest.mycompany.local:8549/ACS?SAMLart</span><span class=o>=</span><span class=s>AAQAAOjXNPPr%2Fr7FO5WpiZ%2B2vAl5KMFibkRaAGwIkwXh%2Bo7DgsG2LMDE58c%3D</span><span class=p>&amp;</span><span class=nt>RelayState</span><span class=o>=</span><span class=s>idp%23468</span>
</code></pre></div> <h4 id=transport-protocol>Transport Protocol<a class=headerlink href=#transport-protocol title="Permanent link"> ¶</a></h4> <p>The transaction uses front channel HTTP communication via the user agent (browser).</p> <h4 id=security-requirements>Security Requirements<a class=headerlink href=#security-requirements title="Permanent link"> ¶</a></h4> <p>The transactions shall use <abbr title="Transport Layer Security">TLS</abbr> secured transports (HTTPS) to ensure data privacy and with server authentication.</p> <h3 id=artifact-resolve>Artifact Resolve<a class=headerlink href=#artifact-resolve title="Permanent link"> ¶</a></h3> <p>The transaction shall be performed by the primary system to exchange the artifact to a SAML 2.0 <abbr title="Identity Provider">IdP</abbr> Assertion.</p> <p>The primary system shall use the SOAP backchannel with an <em>ArtifactResolve</em> request message as defined in <a href=http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf rel="external nofollow noopener" target=_blank>Assertions and Protocols for the OASIS Security Assertion Markup Language (SAML) V2.0</a>.</p> <p>The <abbr title="Identity Provider">IdP</abbr> server responds the SAML 2.0 <abbr title="Identity Provider">IdP</abbr> Assertion of the authenticated user.</p> <h4 id=message-semantics_1>Message Semantics<a class=headerlink href=#message-semantics_1 title="Permanent link"> ¶</a></h4> <h5 id=request-message_1>Request Message<a class=headerlink href=#request-message_1 title="Permanent link"> ¶</a></h5> <p>The following snippet is taken from a sample request recorded during the <abbr title="Electronic Patient Record">EPR</abbr> projectathon in September 2020. Some elements are omitted to increase readability. The raw request file may be found <a href=https://github.com/ehealthsuisse/EPR-by-example/tree/main/Auth_samples/08_ArtifactResolve_raw.xml rel="external nofollow noopener" target=_blank>here</a>.</p> <p>The <em>ArtifactResolve</em> conveys the following information to be set by the primary system:</p> <ul> <li><em>Issuer</em>: A ID of the primary system as URL (line 4 in the example below).</li> <li><em>SignedInfo</em>: Signature metadata and the digest value used for the signature.</li> <li><em>SignatureValue</em>: The signature of the request (line 18 in the example below).</li> <li><em>X509Certificate</em>: The X509 certificate used to sign the request (line 21 in the example below).</li> <li><em>Artifact</em>: The artifact as retrieved from the Authentication Request transaction (line 25).</li> </ul> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>08_ArtifactResolve_raw.xml</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-2-1> 1</a></span>
<span class=normal><a href=#__codelineno-2-2> 2</a></span>
<span class=normal><a href=#__codelineno-2-3> 3</a></span>
<span class=normal><a href=#__codelineno-2-4> 4</a></span>
<span class=normal><a href=#__codelineno-2-5> 5</a></span>
<span class=normal><a href=#__codelineno-2-6> 6</a></span>
<span class=normal><a href=#__codelineno-2-7> 7</a></span>
<span class=normal><a href=#__codelineno-2-8> 8</a></span>
<span class=normal><a href=#__codelineno-2-9> 9</a></span>
<span class=normal><a href=#__codelineno-2-10>10</a></span>
<span class=normal><a href=#__codelineno-2-11>11</a></span>
<span class=normal><a href=#__codelineno-2-12>12</a></span>
<span class=normal><a href=#__codelineno-2-13>13</a></span>
<span class=normal><a href=#__codelineno-2-14>14</a></span>
<span class=normal><a href=#__codelineno-2-15>15</a></span>
<span class=normal><a href=#__codelineno-2-16>16</a></span>
<span class=normal><a href=#__codelineno-2-17>17</a></span>
<span class=normal><a href=#__codelineno-2-18>18</a></span>
<span class=normal><a href=#__codelineno-2-19>19</a></span>
<span class=normal><a href=#__codelineno-2-20>20</a></span>
<span class=normal><a href=#__codelineno-2-21>21</a></span>
<span class=normal><a href=#__codelineno-2-22>22</a></span>
<span class=normal><a href=#__codelineno-2-23>23</a></span>
<span class=normal><a href=#__codelineno-2-24>24</a></span>
<span class=normal><a href=#__codelineno-2-25>25</a></span>
<span class=normal><a href=#__codelineno-2-26>26</a></span>
<span class=normal><a href=#__codelineno-2-27>27</a></span>
<span class=normal><a href=#__codelineno-2-28>28</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1></a><span class=nt>&lt;Envelope</span><span class=w> </span><span class=na>xmlns=</span><span class=s>&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-2-2 name=__codelineno-2-2></a><span class=w>  </span><span class=nt>&lt;Body&gt;</span>
<a id=__codelineno-2-3 name=__codelineno-2-3></a><span class=w>   </span><span class=nt>&lt;ArtifactResolve</span><span class=w> </span><span class=na>xmlns=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;</span><span class=w> </span><span class=na>ID=</span><span class=s>&quot;SAML-D76F77F0-FE57-11EA-8007-9DB4CDFD82EF&quot;</span><span class=w> </span><span class=na>Version=</span><span class=s>&quot;2.0&quot;</span><span class=w> </span><span class=na>IssueInstant=</span><span class=s>&quot;2020-09-24T13:19:41.822+02:00&quot;</span><span class=w> </span><span class=na>Destination=</span><span class=s>&quot;https://fed.idp.ch/nevisauth/services/artifactresolution&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-2-4 name=__codelineno-2-4></a><span class=hll><span class=w>    </span><span class=nt>&lt;Issuer</span><span class=w> </span><span class=na>xmlns=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;</span><span class=nt>&gt;</span>https://epdtest.mycompany.local<span class=nt>&lt;/Issuer&gt;</span>
</span><a id=__codelineno-2-5 name=__codelineno-2-5></a><span class=w>    </span><span class=nt>&lt;Signature</span><span class=w> </span><span class=na>xmlns=</span><span class=s>&quot;http://www.w3.org/2000/09/xmldsig#&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-2-6 name=__codelineno-2-6></a><span class=w>     </span><span class=nt>&lt;SignedInfo&gt;</span>
<a id=__codelineno-2-7 name=__codelineno-2-7></a><span class=w>      </span><span class=nt>&lt;CanonicalizationMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-2-8 name=__codelineno-2-8></a><span class=w>      </span><span class=nt>&lt;SignatureMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-2-9 name=__codelineno-2-9></a><span class=w>      </span><span class=nt>&lt;Reference</span><span class=w> </span><span class=na>URI=</span><span class=s>&quot;#SAML-D76F77F0-FE57-11EA-8007-9DB4CDFD82EF&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-2-10 name=__codelineno-2-10></a><span class=w>       </span><span class=nt>&lt;Transforms&gt;</span>
<a id=__codelineno-2-11 name=__codelineno-2-11></a><span class=w>        </span><span class=nt>&lt;Transform</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-2-12 name=__codelineno-2-12></a><span class=w>        </span><span class=nt>&lt;Transform</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-2-13 name=__codelineno-2-13></a><span class=w>       </span><span class=nt>&lt;/Transforms&gt;</span>
<a id=__codelineno-2-14 name=__codelineno-2-14></a><span class=w>       </span><span class=nt>&lt;DigestMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-2-15 name=__codelineno-2-15></a><span class=w>       </span><span class=nt>&lt;DigestValue&gt;</span>R+bMs3semvJBgae/3wnNVZp0eTpIhQQK4+S2KqRj1bM=<span class=nt>&lt;/DigestValue&gt;</span>
<a id=__codelineno-2-16 name=__codelineno-2-16></a><span class=w>      </span><span class=nt>&lt;/Reference&gt;</span>
<a id=__codelineno-2-17 name=__codelineno-2-17></a><span class=w>     </span><span class=nt>&lt;/SignedInfo&gt;</span>s
<a id=__codelineno-2-18 name=__codelineno-2-18></a><span class=hll><span class=w>     </span><span class=nt>&lt;SignatureValue&gt;</span><span class=w> </span><span class=cm>&lt;!-- omitted for brevity --&gt;</span><span class=w> </span><span class=nt>&lt;/SignatureValue&gt;</span>
</span><a id=__codelineno-2-19 name=__codelineno-2-19></a><span class=w>     </span><span class=nt>&lt;KeyInfo&gt;</span>
<a id=__codelineno-2-20 name=__codelineno-2-20></a><span class=w>      </span><span class=nt>&lt;X509Data&gt;</span>
<a id=__codelineno-2-21 name=__codelineno-2-21></a><span class=hll><span class=w>       </span><span class=nt>&lt;X509Certificate&gt;</span><span class=w> </span><span class=cm>&lt;!-- omitted for brevity --&gt;</span><span class=w> </span><span class=nt>&lt;/X509Certificate&gt;</span>
</span><a id=__codelineno-2-22 name=__codelineno-2-22></a><span class=w>      </span><span class=nt>&lt;/X509Data&gt;</span>
<a id=__codelineno-2-23 name=__codelineno-2-23></a><span class=w>     </span><span class=nt>&lt;/KeyInfo&gt;</span>
<a id=__codelineno-2-24 name=__codelineno-2-24></a><span class=w>    </span><span class=nt>&lt;/Signature&gt;</span>
<a id=__codelineno-2-25 name=__codelineno-2-25></a><span class=hll><span class=w>    </span><span class=nt>&lt;Artifact&gt;</span>AAQAAOjXNPPr/r7FO5WpiZ+2vAl5KMFibkRaAGwIkwXh+o7DgsG2LMDE58c=<span class=nt>&lt;/Artifact&gt;</span>
</span><a id=__codelineno-2-26 name=__codelineno-2-26></a><span class=w>   </span><span class=nt>&lt;/ArtifactResolve&gt;</span>
<a id=__codelineno-2-27 name=__codelineno-2-27></a><span class=w>  </span><span class=nt>&lt;/Body&gt;</span>
<a id=__codelineno-2-28 name=__codelineno-2-28></a><span class=w> </span><span class=nt>&lt;/Envelope&gt;</span>
</code></pre></div></td></tr></table></div> <h5 id=response-message_1>Response Message<a class=headerlink href=#response-message_1 title="Permanent link"> ¶</a></h5> <p>The following snippet is taken from a sample response recorded during the <abbr title="Electronic Patient Record">EPR</abbr> projectathon in September 2020. Some elements are omitted to increase readability. The raw version may be found <a href=https://github.com/ehealthsuisse/EPR-by-example/tree/main/Auth_samples/09_ArtifactResponse_raw.xml rel="external nofollow noopener" target=_blank>here</a>.</p> <p>The <em>ArtifactResponse</em> conveys the following information which shall be evaluated by the primary system:</p> <ul> <li><em>Issuer</em>: A ID of the primary system as URL (line 6 in the example below).</li> <li><em>SignedInfo</em>: Signature metadata and the digest value used for the signature.</li> <li><em>SignatureValue</em>: The signature of the request (line 26 in the example below) which shall be validated by the primary system.</li> <li><em>X509Certificate</em>: The X509 certificate used to sign the request (line 29 in the example below).</li> <li><em>assertion</em>: The <abbr title="Identity Provider">IdP</abbr> assertion conveying the attributes of the authenticated user. </li> </ul> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>09_ArtifactResponse_raw.xml</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-3-1> 1</a></span>
<span class=normal><a href=#__codelineno-3-2> 2</a></span>
<span class=normal><a href=#__codelineno-3-3> 3</a></span>
<span class=normal><a href=#__codelineno-3-4> 4</a></span>
<span class=normal><a href=#__codelineno-3-5> 5</a></span>
<span class=normal><a href=#__codelineno-3-6> 6</a></span>
<span class=normal><a href=#__codelineno-3-7> 7</a></span>
<span class=normal><a href=#__codelineno-3-8> 8</a></span>
<span class=normal><a href=#__codelineno-3-9> 9</a></span>
<span class=normal><a href=#__codelineno-3-10>10</a></span>
<span class=normal><a href=#__codelineno-3-11>11</a></span>
<span class=normal><a href=#__codelineno-3-12>12</a></span>
<span class=normal><a href=#__codelineno-3-13>13</a></span>
<span class=normal><a href=#__codelineno-3-14>14</a></span>
<span class=normal><a href=#__codelineno-3-15>15</a></span>
<span class=normal><a href=#__codelineno-3-16>16</a></span>
<span class=normal><a href=#__codelineno-3-17>17</a></span>
<span class=normal><a href=#__codelineno-3-18>18</a></span>
<span class=normal><a href=#__codelineno-3-19>19</a></span>
<span class=normal><a href=#__codelineno-3-20>20</a></span>
<span class=normal><a href=#__codelineno-3-21>21</a></span>
<span class=normal><a href=#__codelineno-3-22>22</a></span>
<span class=normal><a href=#__codelineno-3-23>23</a></span>
<span class=normal><a href=#__codelineno-3-24>24</a></span>
<span class=normal><a href=#__codelineno-3-25>25</a></span>
<span class=normal><a href=#__codelineno-3-26>26</a></span>
<span class=normal><a href=#__codelineno-3-27>27</a></span>
<span class=normal><a href=#__codelineno-3-28>28</a></span>
<span class=normal><a href=#__codelineno-3-29>29</a></span>
<span class=normal><a href=#__codelineno-3-30>30</a></span>
<span class=normal><a href=#__codelineno-3-31>31</a></span>
<span class=normal><a href=#__codelineno-3-32>32</a></span>
<span class=normal><a href=#__codelineno-3-33>33</a></span>
<span class=normal><a href=#__codelineno-3-34>34</a></span>
<span class=normal><a href=#__codelineno-3-35>35</a></span>
<span class=normal><a href=#__codelineno-3-36>36</a></span>
<span class=normal><a href=#__codelineno-3-37>37</a></span>
<span class=normal><a href=#__codelineno-3-38>38</a></span>
<span class=normal><a href=#__codelineno-3-39>39</a></span>
<span class=normal><a href=#__codelineno-3-40>40</a></span>
<span class=normal><a href=#__codelineno-3-41>41</a></span>
<span class=normal><a href=#__codelineno-3-42>42</a></span>
<span class=normal><a href=#__codelineno-3-43>43</a></span>
<span class=normal><a href=#__codelineno-3-44>44</a></span>
<span class=normal><a href=#__codelineno-3-45>45</a></span>
<span class=normal><a href=#__codelineno-3-46>46</a></span>
<span class=normal><a href=#__codelineno-3-47>47</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1></a><span class=nt>&lt;SOAP-ENV:Envelope</span><span class=w> </span><span class=na>xmlns:SOAP-ENV=</span><span class=s>&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-2 name=__codelineno-3-2></a><span class=w>  </span><span class=nt>&lt;SOAP-ENV:Body&gt;</span>
<a id=__codelineno-3-3 name=__codelineno-3-3></a><span class=w>    </span><span class=nt>&lt;saml2p:ArtifactResponse</span>
<a id=__codelineno-3-4 name=__codelineno-3-4></a><span class=hll><span class=w>      </span><span class=na>xmlns:saml2p=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;</span>
</span><a id=__codelineno-3-5 name=__codelineno-3-5></a><span class=w>      </span><span class=na>xmlns:xs=</span><span class=s>&quot;http://www.w3.org/2001/XMLSchema&quot;</span>
<a id=__codelineno-3-6 name=__codelineno-3-6></a><span class=w>      </span><span class=na>ID=</span><span class=s>&quot;ArtifactResponse_bf738b81c935d2c2f47604e01388553c2407ac40&quot;</span>
<a id=__codelineno-3-7 name=__codelineno-3-7></a><span class=w>      </span><span class=na>InResponseTo=</span><span class=s>&quot;SAML-D76F77F0-FE57-11EA-8007-9DB4CDFD82EF&quot;</span>
<a id=__codelineno-3-8 name=__codelineno-3-8></a><span class=w>      </span><span class=na>IssueInstant=</span><span class=s>&quot;2020-09-24T11:19:42.030Z&quot;</span>
<a id=__codelineno-3-9 name=__codelineno-3-9></a><span class=w>      </span><span class=na>Version=</span><span class=s>&quot;2.0&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-10 name=__codelineno-3-10></a><span class=w>      </span><span class=nt>&lt;saml2:Issuer</span><span class=w> </span><span class=na>xmlns:saml2=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;</span><span class=nt>&gt;</span>fed.idp.ch<span class=nt>&lt;/saml2:Issuer&gt;</span>
<a id=__codelineno-3-11 name=__codelineno-3-11></a><span class=w>      </span><span class=nt>&lt;ds:Signature</span><span class=w> </span><span class=na>xmlns:ds=</span><span class=s>&quot;http://www.w3.org/2000/09/xmldsig#&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-12 name=__codelineno-3-12></a><span class=w>        </span><span class=nt>&lt;ds:SignedInfo&gt;</span>
<a id=__codelineno-3-13 name=__codelineno-3-13></a><span class=w>          </span><span class=nt>&lt;ds:CanonicalizationMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-14 name=__codelineno-3-14></a><span class=w>          </span><span class=nt>&lt;ds:SignatureMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-15 name=__codelineno-3-15></a><span class=w>          </span><span class=nt>&lt;ds:Reference</span><span class=w> </span><span class=na>URI=</span><span class=s>&quot;#ArtifactResponse_bf738b81c935d2c2f47604e01388553c2407ac40&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-16 name=__codelineno-3-16></a><span class=w>            </span><span class=nt>&lt;ds:Transforms&gt;</span>
<a id=__codelineno-3-17 name=__codelineno-3-17></a><span class=w>              </span><span class=nt>&lt;ds:Transform</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-18 name=__codelineno-3-18></a><span class=hll><span class=w>              </span><span class=nt>&lt;ds:Transform</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</span><span class=nt>&gt;</span>
</span><a id=__codelineno-3-19 name=__codelineno-3-19></a><span class=w>                </span><span class=nt>&lt;ec:InclusiveNamespaces</span><span class=w> </span><span class=na>xmlns:ec=</span><span class=s>&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</span><span class=w> </span><span class=na>PrefixList=</span><span class=s>&quot;xs&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-20 name=__codelineno-3-20></a><span class=w>              </span><span class=nt>&lt;/ds:Transform&gt;</span>
<a id=__codelineno-3-21 name=__codelineno-3-21></a><span class=hll><span class=w>            </span><span class=nt>&lt;/ds:Transforms&gt;</span>
</span><a id=__codelineno-3-22 name=__codelineno-3-22></a><span class=w>            </span><span class=nt>&lt;ds:DigestMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2000/09/xmldsig#sha1&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-23 name=__codelineno-3-23></a><span class=w>            </span><span class=nt>&lt;ds:DigestValue&gt;</span>1RZPbh508clAQoKhxnQZEenNFyg=<span class=nt>&lt;/ds:DigestValue&gt;</span>
<a id=__codelineno-3-24 name=__codelineno-3-24></a><span class=w>          </span><span class=nt>&lt;/ds:Reference&gt;</span>
<a id=__codelineno-3-25 name=__codelineno-3-25></a><span class=w>        </span><span class=nt>&lt;/ds:SignedInfo&gt;</span>
<a id=__codelineno-3-26 name=__codelineno-3-26></a><span class=w>        </span><span class=nt>&lt;ds:SignatureValue&gt;</span><span class=cm>&lt;!-- omitted for brevity --&gt;</span><span class=nt>&lt;/ds:SignatureValue&gt;</span>
<a id=__codelineno-3-27 name=__codelineno-3-27></a><span class=w>        </span><span class=nt>&lt;ds:KeyInfo&gt;</span>
<a id=__codelineno-3-28 name=__codelineno-3-28></a><span class=w>          </span><span class=nt>&lt;ds:X509Data&gt;</span>
<a id=__codelineno-3-29 name=__codelineno-3-29></a><span class=w>            </span><span class=nt>&lt;ds:X509SKI&gt;</span>gYMVdgdR5LG/983GRTJIch0a+zU=<span class=nt>&lt;/ds:X509SKI&gt;</span>
<a id=__codelineno-3-30 name=__codelineno-3-30></a><span class=w>          </span><span class=nt>&lt;/ds:X509Data&gt;</span>
<a id=__codelineno-3-31 name=__codelineno-3-31></a><span class=w>        </span><span class=nt>&lt;/ds:KeyInfo&gt;</span>
<a id=__codelineno-3-32 name=__codelineno-3-32></a><span class=w>      </span><span class=nt>&lt;/ds:Signature&gt;</span>
<a id=__codelineno-3-33 name=__codelineno-3-33></a><span class=w>      </span><span class=nt>&lt;saml2p:Status&gt;</span>
<a id=__codelineno-3-34 name=__codelineno-3-34></a><span class=w>        </span><span class=nt>&lt;saml2p:StatusCode</span><span class=w> </span><span class=na>Value=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:status:Success&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-35 name=__codelineno-3-35></a><span class=w>      </span><span class=nt>&lt;/saml2p:Status&gt;</span>
<a id=__codelineno-3-36 name=__codelineno-3-36></a><span class=w>      </span><span class=nt>&lt;saml2p:Response</span>
<a id=__codelineno-3-37 name=__codelineno-3-37></a><span class=w>        </span><span class=na>xmlns:saml2p=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;</span>
<a id=__codelineno-3-38 name=__codelineno-3-38></a><span class=w>        </span><span class=na>Destination=</span><span class=s>&quot;https://epdtest.mycompany.com&quot;</span>
<a id=__codelineno-3-39 name=__codelineno-3-39></a><span class=w>        </span><span class=na>ID=</span><span class=s>&quot;Response_ef5597568f1bc48233cac63c5a51ca3026566d59&quot;</span>
<a id=__codelineno-3-40 name=__codelineno-3-40></a><span class=w>        </span><span class=na>InResponseTo=</span><span class=s>&quot;SAML-CD88202A-FE57-11EA-800A-ACB5C93CFFF0&quot;</span>
<a id=__codelineno-3-41 name=__codelineno-3-41></a><span class=w>        </span><span class=na>IssueInstant=</span><span class=s>&quot;2020-09-24T11:19:41.634Z&quot;</span>
<a id=__codelineno-3-42 name=__codelineno-3-42></a><span class=w>        </span><span class=na>Version=</span><span class=s>&quot;2.0&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-43 name=__codelineno-3-43></a><span class=w>        </span><span class=nt>&lt;saml2:Issuer</span><span class=w> </span><span class=na>xmlns:saml2=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;</span><span class=nt>&gt;</span>fed.idp.ch<span class=nt>&lt;/saml2:Issuer&gt;</span>
<a id=__codelineno-3-44 name=__codelineno-3-44></a><span class=w>        </span><span class=nt>&lt;saml2p:Status&gt;</span>
<a id=__codelineno-3-45 name=__codelineno-3-45></a><span class=w>          </span><span class=nt>&lt;saml2p:StatusCode</span><span class=w> </span><span class=na>Value=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:status:Success&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-46 name=__codelineno-3-46></a><span class=w>        </span><span class=nt>&lt;/saml2p:Status&gt;</span>
<a id=__codelineno-3-47 name=__codelineno-3-47></a><span class=w>        </span><span class=nt>&lt;saml2:Assertion</span><span class=w> </span><span class=na>xmlns:saml2=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;</span><span class=w> </span><span class=na>xmlns:xs=</span><span class=s>&quot;http://www.w3.org/2001/XMLSchema&quot;</span><span class=w> </span><span class=na>ID=</span><span class=s>&quot;Assertion_4f962f0ff6d14c9ea77726da3c2c88bb76fcae67&quot;</span><span class=w> </span><span class=na>IssueInstant=</span><span class=s>&quot;2020-09-24T11:19:41.633Z&quot;</span><span class=w> </span><span class=na>Version=</span><span class=s>&quot;2.0&quot;</span><span class=nt>&gt;</span>
</code></pre></div></td></tr></table></div> <p>The following snippet shows an example of a <abbr title="Identity Provider">IdP</abbr> Assertion conveyed with the response.</p> <p>The primary system must keep the <abbr title="Identity Provider">IdP</abbr> Assertion in memory to use it to authenticate the <a href=../GetXAssertion/ >Get X-User Assertion</a> transaction.</p> <p>The primary system is not required to analyze the <abbr title="Identity Provider">IdP</abbr> Assertion further, but may extract the following information from the assertion:</p> <ul> <li><em>NameID</em> : This element conveys the user ID assigned by <abbr title="Identity Provider">IdP</abbr>. Primary systems may use it to locally authenticate the user in the primary system.</li> <li><em>NotBefore</em> and <em>NotOnOrAfter</em>: The lifetime of the <abbr title="Identity Provider">IdP</abbr> assertion.</li> <li><em>AttributeStatement</em>: <abbr title="Identity Provider">IdP</abbr> shall provide user attributes in the <em>AttributeStatement</em> child elements. At least the <em>givenname</em>, <em>surname</em>, <em>gender</em> and <em>dateofbirth</em> must be provided. Optional fileds may be provided. The optional fields cover the GLN of the healthcare professional and other attributes, the primary system may use internally to identify the authenticated user.</li> </ul> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-4-47> 47</a></span>
<span class=normal><a href=#__codelineno-4-48> 48</a></span>
<span class=normal><a href=#__codelineno-4-49> 49</a></span>
<span class=normal><a href=#__codelineno-4-50> 50</a></span>
<span class=normal><a href=#__codelineno-4-51> 51</a></span>
<span class=normal><a href=#__codelineno-4-52> 52</a></span>
<span class=normal><a href=#__codelineno-4-53> 53</a></span>
<span class=normal><a href=#__codelineno-4-54> 54</a></span>
<span class=normal><a href=#__codelineno-4-55> 55</a></span>
<span class=normal><a href=#__codelineno-4-56> 56</a></span>
<span class=normal><a href=#__codelineno-4-57> 57</a></span>
<span class=normal><a href=#__codelineno-4-58> 58</a></span>
<span class=normal><a href=#__codelineno-4-59> 59</a></span>
<span class=normal><a href=#__codelineno-4-60> 60</a></span>
<span class=normal><a href=#__codelineno-4-61> 61</a></span>
<span class=normal><a href=#__codelineno-4-62> 62</a></span>
<span class=normal><a href=#__codelineno-4-63> 63</a></span>
<span class=normal><a href=#__codelineno-4-64> 64</a></span>
<span class=normal><a href=#__codelineno-4-65> 65</a></span>
<span class=normal><a href=#__codelineno-4-66> 66</a></span>
<span class=normal><a href=#__codelineno-4-67> 67</a></span>
<span class=normal><a href=#__codelineno-4-68> 68</a></span>
<span class=normal><a href=#__codelineno-4-69> 69</a></span>
<span class=normal><a href=#__codelineno-4-70> 70</a></span>
<span class=normal><a href=#__codelineno-4-71> 71</a></span>
<span class=normal><a href=#__codelineno-4-72> 72</a></span>
<span class=normal><a href=#__codelineno-4-73> 73</a></span>
<span class=normal><a href=#__codelineno-4-74> 74</a></span>
<span class=normal><a href=#__codelineno-4-75> 75</a></span>
<span class=normal><a href=#__codelineno-4-76> 76</a></span>
<span class=normal><a href=#__codelineno-4-77> 77</a></span>
<span class=normal><a href=#__codelineno-4-78> 78</a></span>
<span class=normal><a href=#__codelineno-4-79> 79</a></span>
<span class=normal><a href=#__codelineno-4-80> 80</a></span>
<span class=normal><a href=#__codelineno-4-81> 81</a></span>
<span class=normal><a href=#__codelineno-4-82> 82</a></span>
<span class=normal><a href=#__codelineno-4-83> 83</a></span>
<span class=normal><a href=#__codelineno-4-84> 84</a></span>
<span class=normal><a href=#__codelineno-4-85> 85</a></span>
<span class=normal><a href=#__codelineno-4-86> 86</a></span>
<span class=normal><a href=#__codelineno-4-87> 87</a></span>
<span class=normal><a href=#__codelineno-4-88> 88</a></span>
<span class=normal><a href=#__codelineno-4-89> 89</a></span>
<span class=normal><a href=#__codelineno-4-90> 90</a></span>
<span class=normal><a href=#__codelineno-4-91> 91</a></span>
<span class=normal><a href=#__codelineno-4-92> 92</a></span>
<span class=normal><a href=#__codelineno-4-93> 93</a></span>
<span class=normal><a href=#__codelineno-4-94> 94</a></span>
<span class=normal><a href=#__codelineno-4-95> 95</a></span>
<span class=normal><a href=#__codelineno-4-96> 96</a></span>
<span class=normal><a href=#__codelineno-4-97> 97</a></span>
<span class=normal><a href=#__codelineno-4-98> 98</a></span>
<span class=normal><a href=#__codelineno-4-99> 99</a></span>
<span class=normal><a href=#__codelineno-4-100>100</a></span>
<span class=normal><a href=#__codelineno-4-101>101</a></span>
<span class=normal><a href=#__codelineno-4-102>102</a></span>
<span class=normal><a href=#__codelineno-4-103>103</a></span>
<span class=normal><a href=#__codelineno-4-104>104</a></span>
<span class=normal><a href=#__codelineno-4-105>105</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-4-47 name=__codelineno-4-47></a><span class=w>        </span><span class=nt>&lt;saml2:Assertion</span><span class=w> </span><span class=na>xmlns:saml2=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;</span><span class=w> </span><span class=na>xmlns:xs=</span><span class=s>&quot;http://www.w3.org/2001/XMLSchema&quot;</span><span class=w> </span><span class=na>ID=</span><span class=s>&quot;Assertion_4f962f0ff6d14c9ea77726da3c2c88bb76fcae67&quot;</span><span class=w> </span><span class=na>IssueInstant=</span><span class=s>&quot;2020-09-24T11:19:41.633Z&quot;</span><span class=w> </span><span class=na>Version=</span><span class=s>&quot;2.0&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-48 name=__codelineno-4-48></a><span class=w>          </span><span class=nt>&lt;saml2:Issuer&gt;</span>fed.idp.ch<span class=nt>&lt;/saml2:Issuer&gt;</span>
<a id=__codelineno-4-49 name=__codelineno-4-49></a><span class=w>          </span><span class=nt>&lt;ds:Signature</span><span class=w> </span><span class=na>xmlns:ds=</span><span class=s>&quot;http://www.w3.org/2000/09/xmldsig#&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-50 name=__codelineno-4-50></a><span class=w>            </span><span class=nt>&lt;ds:SignedInfo&gt;</span>
<a id=__codelineno-4-51 name=__codelineno-4-51></a><span class=w>              </span><span class=nt>&lt;ds:CanonicalizationMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-4-52 name=__codelineno-4-52></a><span class=w>              </span><span class=nt>&lt;ds:SignatureMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-4-53 name=__codelineno-4-53></a><span class=w>              </span><span class=nt>&lt;ds:Reference</span><span class=w> </span><span class=na>URI=</span><span class=s>&quot;#Assertion_4f962f0ff6d14c9ea77726da3c2c88bb76fcae67&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-54 name=__codelineno-4-54></a><span class=w>                </span><span class=nt>&lt;ds:Transforms&gt;</span>
<a id=__codelineno-4-55 name=__codelineno-4-55></a><span class=w>                  </span><span class=nt>&lt;ds:Transform</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-4-56 name=__codelineno-4-56></a><span class=w>                  </span><span class=nt>&lt;ds:Transform</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-57 name=__codelineno-4-57></a><span class=w>                    </span><span class=nt>&lt;ec:InclusiveNamespaces</span><span class=w> </span><span class=na>xmlns:ec=</span><span class=s>&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</span><span class=w> </span><span class=na>PrefixList=</span><span class=s>&quot;xs&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-4-58 name=__codelineno-4-58></a><span class=w>                  </span><span class=nt>&lt;/ds:Transform&gt;</span>
<a id=__codelineno-4-59 name=__codelineno-4-59></a><span class=w>                </span><span class=nt>&lt;/ds:Transforms&gt;</span>
<a id=__codelineno-4-60 name=__codelineno-4-60></a><span class=w>                </span><span class=nt>&lt;ds:DigestMethod</span><span class=w> </span><span class=na>Algorithm=</span><span class=s>&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-4-61 name=__codelineno-4-61></a><span class=w>                </span><span class=nt>&lt;ds:DigestValue&gt;</span>P/I9Ym+p/Zzs0ANXHmAjqZcuBp2FJ75j6oCM6Gd0bVg=<span class=nt>&lt;/ds:DigestValue&gt;</span>
<a id=__codelineno-4-62 name=__codelineno-4-62></a><span class=w>              </span><span class=nt>&lt;/ds:Reference&gt;</span>
<a id=__codelineno-4-63 name=__codelineno-4-63></a><span class=w>            </span><span class=nt>&lt;/ds:SignedInfo&gt;</span>
<a id=__codelineno-4-64 name=__codelineno-4-64></a><span class=w>            </span><span class=nt>&lt;ds:SignatureValue&gt;</span><span class=cm>&lt;!-- omitted for brevity --&gt;</span><span class=nt>&lt;/ds:SignatureValue&gt;</span>
<a id=__codelineno-4-65 name=__codelineno-4-65></a><span class=w>            </span><span class=nt>&lt;ds:KeyInfo&gt;</span>
<a id=__codelineno-4-66 name=__codelineno-4-66></a><span class=w>              </span><span class=nt>&lt;ds:X509Data&gt;</span>
<a id=__codelineno-4-67 name=__codelineno-4-67></a><span class=w>                </span><span class=nt>&lt;ds:X509Certificate&gt;</span><span class=cm>&lt;!-- omitted for brevity --&gt;</span><span class=nt>&lt;/ds:X509Certificate&gt;</span>
<a id=__codelineno-4-68 name=__codelineno-4-68></a><span class=w>              </span><span class=nt>&lt;/ds:X509Data&gt;</span>
<a id=__codelineno-4-69 name=__codelineno-4-69></a><span class=w>            </span><span class=nt>&lt;/ds:KeyInfo&gt;</span>
<a id=__codelineno-4-70 name=__codelineno-4-70></a><span class=w>          </span><span class=nt>&lt;/ds:Signature&gt;</span>
<a id=__codelineno-4-71 name=__codelineno-4-71></a><span class=w>          </span><span class=nt>&lt;saml2:Subject&gt;</span>
<a id=__codelineno-4-72 name=__codelineno-4-72></a><span class=w>            </span><span class=nt>&lt;saml2:NameID</span><span class=w> </span><span class=na>Format=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;</span><span class=nt>&gt;</span>pjtt31<span class=nt>&lt;/saml2:NameID&gt;</span>
<a id=__codelineno-4-73 name=__codelineno-4-73></a><span class=w>            </span><span class=nt>&lt;saml2:SubjectConfirmation</span><span class=w> </span><span class=na>Method=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-74 name=__codelineno-4-74></a><span class=w>              </span><span class=nt>&lt;saml2:SubjectConfirmationData</span><span class=w> </span><span class=na>InResponseTo=</span><span class=s>&quot;SAML-CD88202A-FE57-11EA-800A-ACB5C93CFFF0&quot;</span><span class=w> </span><span class=na>NotOnOrAfter=</span><span class=s>&quot;2020-09-24T12:19:41.634Z&quot;</span><span class=w> </span><span class=na>Recipient=</span><span class=s>&quot;https://epdtest.mycompany.com&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-4-75 name=__codelineno-4-75></a><span class=w>            </span><span class=nt>&lt;/saml2:SubjectConfirmation&gt;</span>
<a id=__codelineno-4-76 name=__codelineno-4-76></a><span class=w>          </span><span class=nt>&lt;/saml2:Subject&gt;</span>
<a id=__codelineno-4-77 name=__codelineno-4-77></a><span class=w>          </span><span class=nt>&lt;saml2:Conditions</span><span class=w> </span><span class=na>NotBefore=</span><span class=s>&quot;2020-09-24T11:19:41.633Z&quot;</span><span class=w> </span><span class=na>NotOnOrAfter=</span><span class=s>&quot;2020-09-24T12:09:41.633Z&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-78 name=__codelineno-4-78></a><span class=w>            </span><span class=nt>&lt;saml2:AudienceRestriction&gt;</span>
<a id=__codelineno-4-79 name=__codelineno-4-79></a><span class=w>              </span><span class=nt>&lt;saml2:Audience&gt;</span>https://epdtest.mycompany.com<span class=nt>&lt;/saml2:Audience&gt;</span>
<a id=__codelineno-4-80 name=__codelineno-4-80></a><span class=w>            </span><span class=nt>&lt;/saml2:AudienceRestriction&gt;</span>
<a id=__codelineno-4-81 name=__codelineno-4-81></a><span class=w>          </span><span class=nt>&lt;/saml2:Conditions&gt;</span>
<a id=__codelineno-4-82 name=__codelineno-4-82></a><span class=w>          </span><span class=nt>&lt;saml2:AuthnStatement</span><span class=w> </span><span class=na>AuthnInstant=</span><span class=s>&quot;2020-09-24T11:19:41.633Z&quot;</span><span class=w> </span><span class=na>SessionNotOnOrAfter=</span><span class=s>&quot;2020-09-24T13:19:41.633Z&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-83 name=__codelineno-4-83></a><span class=w>            </span><span class=nt>&lt;saml2:AuthnContext&gt;</span>
<a id=__codelineno-4-84 name=__codelineno-4-84></a><span class=w>              </span><span class=nt>&lt;saml2:AuthnContextClassRef&gt;</span>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified<span class=nt>&lt;/saml2:AuthnContextClassRef&gt;</span>
<a id=__codelineno-4-85 name=__codelineno-4-85></a><span class=w>            </span><span class=nt>&lt;/saml2:AuthnContext&gt;</span>
<a id=__codelineno-4-86 name=__codelineno-4-86></a><span class=w>          </span><span class=nt>&lt;/saml2:AuthnStatement&gt;</span>
<a id=__codelineno-4-87 name=__codelineno-4-87></a><span class=w>          </span><span class=nt>&lt;saml2:AttributeStatement&gt;</span>
<a id=__codelineno-4-88 name=__codelineno-4-88></a><span class=w>            </span><span class=cm>&lt;!-- other vendor specific attributes omitted for brevity --&gt;</span>
<a id=__codelineno-4-89 name=__codelineno-4-89></a><span class=w>            </span><span class=nt>&lt;saml2:Attribute</span><span class=w> </span><span class=na>Name=</span><span class=s>&quot;GLN&quot;</span><span class=w> </span><span class=na>NameFormat=</span><span class=s>&quot;urn:oasis:names:tc:ebcore:partyid-type:DataUniversalNumberingSystem:0060&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-90 name=__codelineno-4-90></a><span class=w>             </span><span class=nt>&lt;saml2:AttributeValue</span><span class=w> </span><span class=na>xmlns:xsi=</span><span class=s>&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class=w> </span><span class=na>xsi:type=</span><span class=s>&quot;xs:token&quot;</span><span class=nt>&gt;</span>9801000050702<span class=nt>&lt;/saml2:AttributeValue&gt;</span>
<a id=__codelineno-4-91 name=__codelineno-4-91></a><span class=w>            </span><span class=nt>&lt;/saml2:Attribute&gt;</span>
<a id=__codelineno-4-92 name=__codelineno-4-92></a><span class=w>            </span><span class=nt>&lt;saml2:Attribute</span><span class=w> </span><span class=na>Name=</span><span class=s>&quot;http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname&quot;</span><span class=w> </span><span class=na>NameFormat=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:uri&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-93 name=__codelineno-4-93></a><span class=w>              </span><span class=nt>&lt;saml2:AttributeValue</span><span class=w> </span><span class=na>xmlns:xsi=</span><span class=s>&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class=w> </span><span class=na>xsi:type=</span><span class=s>&quot;xs:string&quot;</span><span class=nt>&gt;</span>Martina<span class=nt>&lt;/saml2:AttributeValue&gt;</span>
<a id=__codelineno-4-94 name=__codelineno-4-94></a><span class=w>            </span><span class=nt>&lt;/saml2:Attribute&gt;</span>
<a id=__codelineno-4-95 name=__codelineno-4-95></a><span class=w>            </span><span class=nt>&lt;saml2:Attribute</span><span class=w> </span><span class=na>Name=</span><span class=s>&quot;http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname&quot;</span><span class=w> </span><span class=na>NameFormat=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:uri&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-96 name=__codelineno-4-96></a><span class=w>              </span><span class=nt>&lt;saml2:AttributeValue</span><span class=w> </span><span class=na>xmlns:xsi=</span><span class=s>&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class=w> </span><span class=na>xsi:type=</span><span class=s>&quot;xs:string&quot;</span><span class=nt>&gt;</span>Musterarzt<span class=nt>&lt;/saml2:AttributeValue&gt;</span>
<a id=__codelineno-4-97 name=__codelineno-4-97></a><span class=w>            </span><span class=nt>&lt;/saml2:Attribute&gt;</span>
<a id=__codelineno-4-98 name=__codelineno-4-98></a><span class=w>            </span><span class=nt>&lt;saml2:Attribute</span><span class=w> </span><span class=na>Name=</span><span class=s>&quot;gender&quot;</span><span class=w> </span><span class=na>NameFormat=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:uri&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-99 name=__codelineno-4-99></a><span class=w>              </span><span class=nt>&lt;saml2:AttributeValue</span><span class=w> </span><span class=na>xmlns:xsi=</span><span class=s>&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class=w> </span><span class=na>xsi:type=</span><span class=s>&quot;xs:token&quot;</span><span class=nt>&gt;</span>F<span class=nt>&lt;/saml2:AttributeValue&gt;</span>
<a id=__codelineno-4-100 name=__codelineno-4-100></a><span class=w>            </span><span class=nt>&lt;/saml2:Attribute&gt;</span>
<a id=__codelineno-4-101 name=__codelineno-4-101></a><span class=w>            </span><span class=nt>&lt;saml2:Attribute</span><span class=w> </span><span class=na>Name=</span><span class=s>&quot;dateofbirth&quot;</span><span class=w> </span><span class=na>NameFormat=</span><span class=s>&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:uri&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-4-102 name=__codelineno-4-102></a><span class=w>              </span><span class=nt>&lt;saml2:AttributeValue</span><span class=w> </span><span class=na>xmlns:xsi=</span><span class=s>&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class=w> </span><span class=na>xsi:type=</span><span class=s>&quot;xs:date&quot;</span><span class=nt>&gt;</span>1990-09-06<span class=nt>&lt;/saml2:AttributeValue&gt;</span>
<a id=__codelineno-4-103 name=__codelineno-4-103></a><span class=w>            </span><span class=nt>&lt;/saml2:Attribute&gt;</span>
<a id=__codelineno-4-104 name=__codelineno-4-104></a><span class=w>          </span><span class=nt>&lt;/saml2:AttributeStatement&gt;</span>
<a id=__codelineno-4-105 name=__codelineno-4-105></a><span class=w>        </span><span class=nt>&lt;/saml2:Assertion&gt;</span>
</code></pre></div></td></tr></table></div> <h4 id=transport-protocol_1>Transport Protocol<a class=headerlink href=#transport-protocol_1 title="Permanent link"> ¶</a></h4> <p>The primary system shall send the request messages to the <abbr title="Identity Provider">IdP</abbr> of the community using the http POST binding as defined in the <a href=https://www.w3.org/TR/2007/REC-soap12-part0-20070427/#L26866 rel="external nofollow noopener" target=_blank>W3C SOAP specification</a>. It may look like: </p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-5-1>1</a></span>
<span class=normal><a href=#__codelineno-5-2>2</a></span>
<span class=normal><a href=#__codelineno-5-3>3</a></span>
<span class=normal><a href=#__codelineno-5-4>4</a></span>
<span class=normal><a href=#__codelineno-5-5>5</a></span>
<span class=normal><a href=#__codelineno-5-6>6</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1></a><span class=nf>POST</span> <span class=nn>/IdPAuthenticationService</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
<a id=__codelineno-5-2 name=__codelineno-5-2></a><span class=na>Host</span><span class=o>:</span> <span class=l>idp.example.org</span>
<a id=__codelineno-5-3 name=__codelineno-5-3></a><span class=na>Accept-Encoding</span><span class=o>:</span> <span class=l>gzip, deflate</span>
<a id=__codelineno-5-4 name=__codelineno-5-4></a><span class=na>Connection</span><span class=o>:</span> <span class=l>Keep-Alive</span>
<a id=__codelineno-5-5 name=__codelineno-5-5></a><span class=na>Content-Type</span><span class=o>:</span> <span class=l>application/soap+xml; charset=&quot;utf-8&quot;</span>
<a id=__codelineno-5-6 name=__codelineno-5-6></a><span class=na>Content-Length</span><span class=o>:</span> <span class=l>nnnn  </span>
</code></pre></div></td></tr></table></div> <h4 id=security-requirements_1>Security Requirements<a class=headerlink href=#security-requirements_1 title="Permanent link"> ¶</a></h4> <p>The Artifact Resolve transaction shall be secured by using the SOAP backchannel with <abbr title="Transport Layer Security">TLS</abbr> and mutual authentication with client and server certificate validation. The certificates shall be exchanged during the client registration process. </p> <h3 id=audit-log>Audit Log<a class=headerlink href=#audit-log title="Permanent link"> ¶</a></h3> <p>Primary systems shall protocol the transaction in their logs to ensure traceability. No further requirements are defined in the ordinances of the Swiss <abbr title="Electronic Patient Record">EPR</abbr>.</p> <h2 id=test-opportunity>Test Opportunity<a class=headerlink href=#test-opportunity title="Permanent link"> ¶</a></h2> <p>The transaction can be tested with the test suite of the <a href=../gazelle/ ><abbr title="Electronic Patient Record">EPR</abbr> reference environment</a>, test systems of the <abbr title="Electronic Patient Record">EPR</abbr> communities or the <a href=../playground/ ><abbr title="Electronic Patient Record">EPR</abbr> Playground</a>.</p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2025-01-27T09:58:37+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-01-27</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> <a href=https://www.e-health-suisse.ch/ >eHealth Suisse</a> | <a href=https://github.com/ehealthsuisse/EPR-by-example/blob/main/LICENSE><em>Creative Commons Zero v1.0 Universal</em></a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.copy", "search.suggest", "search.highlight", "navigation.sections", "navigation.expand", "toc.follow"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.cd18aaf1.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> </body> </html>