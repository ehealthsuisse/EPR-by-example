<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The pages explain the transactions by using samples recorded or adapted from transactions performed during the annual Swiss projectathon (September 2020)."><meta name=author content="eHealth Suisse"><link href=https://ehealthsuisse.github.io/EPR-by-example/RetrieveDocumentSet/ rel=canonical><link href=../RegistryStoredQuery/ rel=prev><link href=../ProvideAndRegister/ rel=next><link rel=icon href=../media/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.4.14"><title>Retrieve Document Set - EPR by example</title><link rel=stylesheet href=../assets/stylesheets/main.fad675c6.min.css><link rel=stylesheet href=../assets/stylesheets/palette.356b1318.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../media/ehealthsuisse.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=custom> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#retrieve-document-set class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=https://www.e-health-suisse.ch/ title="EPR by example" class="md-header__button md-logo" aria-label="EPR by example" data-md-component=logo> <img src=../media/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> EPR by example </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Retrieve Document Set </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://www.e-health-suisse.ch/ title="EPR by example" class="md-nav__button md-logo" aria-label="EPR by example" data-md-component=logo> <img src=../media/logo.svg alt=logo> </a> EPR by example </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Patient Management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Patient Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../PDQ/ class=md-nav__link> <span class=md-ellipsis> Patient Demographics Query </span> </a> </li> <li class=md-nav__item> <a href=../PIXFeed/ class=md-nav__link> <span class=md-ellipsis> PIX Feed </span> </a> </li> <li class=md-nav__item> <a href=../PIXQuery/ class=md-nav__link> <span class=md-ellipsis> PIX Query </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Document Management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Document Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../RegistryStoredQuery/ class=md-nav__link> <span class=md-ellipsis> Registry Stored Query </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Retrieve Document Set </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Retrieve Document Set </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#transaction class=md-nav__link> <span class=md-ellipsis> Transaction </span> </a> <nav class=md-nav aria-label=Transaction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#message-semantics class=md-nav__link> <span class=md-ellipsis> Message Semantics </span> </a> <nav class=md-nav aria-label="Message Semantics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#request-message class=md-nav__link> <span class=md-ellipsis> Request Message </span> </a> </li> <li class=md-nav__item> <a href=#response-message class=md-nav__link> <span class=md-ellipsis> Response Message </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transport-protocol class=md-nav__link> <span class=md-ellipsis> Transport Protocol </span> </a> </li> <li class=md-nav__item> <a href=#audit-log class=md-nav__link> <span class=md-ellipsis> Audit Log </span> </a> </li> <li class=md-nav__item> <a href=#security-requirements class=md-nav__link> <span class=md-ellipsis> Security Requirements </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#test-opportunity class=md-nav__link> <span class=md-ellipsis> Test Opportunity </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../ProvideAndRegister/ class=md-nav__link> <span class=md-ellipsis> Provide and Register Document Set </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Authentication </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Authentication </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../AuthenticateUser/ class=md-nav__link> <span class=md-ellipsis> Authenticate User </span> </a> </li> <li class=md-nav__item> <a href=../IdPRenew/ class=md-nav__link> <span class=md-ellipsis> IdP Renew </span> </a> </li> <li class=md-nav__item> <a href=../SSOLogout/ class=md-nav__link> <span class=md-ellipsis> SSO Logout </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex> <span class=md-ellipsis> Authorization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Authorization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../GetXAssertion/ class=md-nav__link> <span class=md-ellipsis> Get X-User Assertion </span> </a> </li> <li class=md-nav__item> <a href=../ProvideXAssertion/ class=md-nav__link> <span class=md-ellipsis> Provide X-User Assertion </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex> <span class=md-ellipsis> Audit </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Audit </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Atna/ class=md-nav__link> <span class=md-ellipsis> Audit logs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> Public Test Systems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Public Test Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../playground/ class=md-nav__link> <span class=md-ellipsis> EPR Playground </span> </a> </li> <li class=md-nav__item> <a href=../gazelle/ class=md-nav__link> <span class=md-ellipsis> EPR Reference Environment </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex> <span class=md-ellipsis> Swiss EPR Exchange Formats </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Swiss EPR Exchange Formats </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../MedicationCardDocument/ class=md-nav__link> <span class=md-ellipsis> Medication Card document </span> </a> </li> <li class=md-nav__item> <a href=../ImmunizationAdministrationDocument/ class=md-nav__link> <span class=md-ellipsis> Immunization Administration Document </span> </a> </li> <li class=md-nav__item> <a href=../Questionnaire/ class=md-nav__link> <span class=md-ellipsis> How to build a FHIR-Questionnaire </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#transaction class=md-nav__link> <span class=md-ellipsis> Transaction </span> </a> <nav class=md-nav aria-label=Transaction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#message-semantics class=md-nav__link> <span class=md-ellipsis> Message Semantics </span> </a> <nav class=md-nav aria-label="Message Semantics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#request-message class=md-nav__link> <span class=md-ellipsis> Request Message </span> </a> </li> <li class=md-nav__item> <a href=#response-message class=md-nav__link> <span class=md-ellipsis> Response Message </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transport-protocol class=md-nav__link> <span class=md-ellipsis> Transport Protocol </span> </a> </li> <li class=md-nav__item> <a href=#audit-log class=md-nav__link> <span class=md-ellipsis> Audit Log </span> </a> </li> <li class=md-nav__item> <a href=#security-requirements class=md-nav__link> <span class=md-ellipsis> Security Requirements </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#test-opportunity class=md-nav__link> <span class=md-ellipsis> Test Opportunity </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=retrieve-document-set>Retrieve Document Set<a class=headerlink href=#retrieve-document-set title="Permanent link"> ¶</a></h1> <p>Transaction to retrieve one or more documents from a community. Primary systems shall use this transaction to read documents from the <abbr title="Electronic Patient Record">EPR</abbr> and integrate to the primary system or to display the document in the UI. </p> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link"> ¶</a></h2> <p>Primary systems shall use this transaction to retrieve documents from a patients <abbr title="Electronic Patient Record">EPR</abbr>. In the Swiss <abbr title="Electronic Patient Record">EPR</abbr> the <a href=https://profiles.ihe.net/ITI/TF/Volume1/ch-10.html rel="external nofollow noopener" target=_blank>IHE XDS.b</a> profile and transactions shall be used.</p> <p>To retrieve the document metadata of the document, the the primary system shall perform a <a href=https://profiles.ihe.net/ITI/TF/Volume2/ITI-43.html rel="external nofollow noopener" target=_blank>Retrieve Document Set [ITI-43]</a> transaction. Within the request, the primary systems shall provide the master patient ID as retrieved from the <a href=../PIXQuery/ >PIX Query</a>, and the repository as well as the documents unique IDs taken from the response of the <a href=../RegistryStoredQuery/ >Registry Stored Query</a>. In the Swiss <abbr title="Electronic Patient Record">EPR</abbr> currently only supports the synchronous exchange option is supported. </p> <p>The community responds the set of documents.</p> <h2 id=transaction>Transaction<a class=headerlink href=#transaction title="Permanent link"> ¶</a></h2> <h3 id=message-semantics>Message Semantics<a class=headerlink href=#message-semantics title="Permanent link"> ¶</a></h3> <p>Messages are encoded as described in the <a href=http://www.ebxml.org rel="external nofollow noopener" target=_blank>ebXML</a> standard with restrictions defined in the IHE profile and the ordinances to the Swiss <abbr title="Electronic Patient Record">EPR</abbr>.</p> <h4 id=request-message>Request Message<a class=headerlink href=#request-message title="Permanent link"> ¶</a></h4> <p>The following snippet displays a sample request recorded during the <abbr title="Electronic Patient Record">EPR</abbr> projectathon in September 2020, with abrevations to increase readability. The raw request file may be found <a href=https://github.com/ehealthsuisse/EPR-by-example/tree/main/samples/ITI-43_request_raw.xml rel="external nofollow noopener" target=_blank>here</a>.</p> <p>The request message shall be a XML SOAP envelope with the query embedded in the <em>Body</em> element of the SOAP envelope. The SOAP <em>Header</em> element conveys the following information:</p> <ul> <li><em>To</em> element: The URL of the repository service.</li> <li><em>MessageID</em> element: a UUID of the message.</li> <li><em>Action</em> element: The SOAP action identifier of the query as defined in the IHE ITI Technical Framework.</li> <li><em>Security</em> element: The Web Service Security header as defined in the <a href=http://docs.oasis-open.org/wss-m/wss/v1.1.1/os/wss-SOAPMessageSecurity-v1.1.1-os.html rel="external nofollow noopener" target=_blank>WS Security</a> specification. This element conveys the <abbr title="X-User Assertion">XUA</abbr> Assertion used for authorization (see <a href=../ProvideXAssertion/ >Provide X-User Assertion</a>). </li> </ul> <p>The SOAP <em>Body</em> element conveys the ebXML <em>RetrieveDocumentSetRequest</em> which shall convey 1..N <em>DocumentRequest</em> elements (lines 12 to 16 below) with the following information:</p> <ul> <li><em>HomeCommunityId</em> : Unique ID of the community.</li> <li><em>RepositoryUniqueId</em>: Unique ID of repository taken from a <a href=../RegistryStoredQuery/ >Registry Stored Query</a> response.</li> <li><em>DocumentUniqueId</em>: Unique ID of the document taken from a Registry Stored Query response.</li> </ul> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>ITI-43_request.xml</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1> 1</a></span>
<span class=normal><a href=#__codelineno-0-2> 2</a></span>
<span class=normal><a href=#__codelineno-0-3> 3</a></span>
<span class=normal><a href=#__codelineno-0-4> 4</a></span>
<span class=normal><a href=#__codelineno-0-5> 5</a></span>
<span class=normal><a href=#__codelineno-0-6> 6</a></span>
<span class=normal><a href=#__codelineno-0-7> 7</a></span>
<span class=normal><a href=#__codelineno-0-8> 8</a></span>
<span class=normal><a href=#__codelineno-0-9> 9</a></span>
<span class=normal><a href=#__codelineno-0-10>10</a></span>
<span class=normal><a href=#__codelineno-0-11>11</a></span>
<span class=normal><a href=#__codelineno-0-12>12</a></span>
<span class=normal><a href=#__codelineno-0-13>13</a></span>
<span class=normal><a href=#__codelineno-0-14>14</a></span>
<span class=normal><a href=#__codelineno-0-15>15</a></span>
<span class=normal><a href=#__codelineno-0-16>16</a></span>
<span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1></a><span class=cp>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<a id=__codelineno-0-2 name=__codelineno-0-2></a><span class=nt>&lt;soapenv:Envelope</span><span class=w> </span><span class=na>xmlns=</span><span class=s>&quot; !-- namespaces omitted -- &quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-0-3 name=__codelineno-0-3></a><span class=w>  </span><span class=nt>&lt;soapenv:Header&gt;</span>
<a id=__codelineno-0-4 name=__codelineno-0-4></a><span class=w>    </span><span class=nt>&lt;wsa:To</span><span class=w> </span><span class=na>soapenv:mustUnderstand=</span><span class=s>&quot;1&quot;</span><span class=nt>&gt;</span>https://epd-test.com/Repository/services/RepositoryService<span class=nt>&lt;/wsa:To&gt;</span>
<a id=__codelineno-0-5 name=__codelineno-0-5></a><span class=w>    </span><span class=nt>&lt;wsa:MessageID</span><span class=w> </span><span class=na>soapenv:mustUnderstand=</span><span class=s>&quot;1&quot;</span><span class=nt>&gt;</span>urn:uuid:1EB10F67-6562-46D5-9B6B-5DC42EB2B4A6<span class=nt>&lt;/wsa:MessageID&gt;</span>
<a id=__codelineno-0-6 name=__codelineno-0-6></a><span class=w>    </span><span class=nt>&lt;wsa:Action</span><span class=w> </span><span class=na>soapenv:mustUnderstand=</span><span class=s>&quot;1&quot;</span><span class=nt>&gt;</span>urn:ihe:iti:2007:RetrieveDocumentSet<span class=nt>&lt;/wsa:Action&gt;</span>
<a id=__codelineno-0-7 name=__codelineno-0-7></a><span class=w>    </span><span class=nt>&lt;wsse:Security&gt;</span>
<a id=__codelineno-0-8 name=__codelineno-0-8></a><span class=w>      </span><span class=nt>&lt;saml2:Assertion&gt;</span><span class=w> </span><span class=cm>&lt;!-- XUA assertion omitted --&gt;</span><span class=nt>&lt;/saml2:Assertion&gt;</span>
<a id=__codelineno-0-9 name=__codelineno-0-9></a><span class=w>    </span><span class=nt>&lt;/wsse:Security&gt;</span>
<a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=w>  </span><span class=nt>&lt;/soapenv:Header&gt;</span>
<a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=w>  </span><span class=nt>&lt;soapenv:Body&gt;</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a><span class=w>    </span><span class=nt>&lt;xsdb:RetrieveDocumentSetRequest&gt;</span>
<a id=__codelineno-0-13 name=__codelineno-0-13></a><span class=hll><span class=w>      </span><span class=nt>&lt;xsdb:DocumentRequest&gt;</span>
</span><a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=hll><span class=w>        </span><span class=nt>&lt;xsdb:HomeCommunityId&gt;</span>urn:oid:1.3.6.1.4.1.21367.2017.2.6.19<span class=nt>&lt;/xsdb:HomeCommunityId&gt;</span>
</span><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=hll><span class=w>        </span><span class=nt>&lt;xsdb:RepositoryUniqueId&gt;</span>1.3.6.1.4.1.21367.2017.2.3.54<span class=nt>&lt;/xsdb:RepositoryUniqueId&gt;</span>
</span><a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=w>        </span><span class=nt>&lt;xsdb:DocumentUniqueId&gt;</span>1.3.6.1.4.1.21367.2017.2.1.75.20200922130227623<span class=nt>&lt;/xsdb:DocumentUniqueId&gt;</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=w>      </span><span class=nt>&lt;/xsdb:DocumentRequest&gt;</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=w>    </span><span class=nt>&lt;/xsdb:RetrieveDocumentSetRequest&gt;</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=w>  </span><span class=nt>&lt;/soapenv:Body&gt;</span>
<a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=nt>&lt;/soapenv:Envelope&gt;</span>
</code></pre></div></td></tr></table></div> <h4 id=response-message>Response Message<a class=headerlink href=#response-message title="Permanent link"> ¶</a></h4> <p>The following snippet displays a sample response recorded during the <abbr title="Electronic Patient Record">EPR</abbr> projectathon in September 2020, with abrevations to increase readability. The raw request file may be found <a href=https://github.com/ehealthsuisse/EPR-by-example/tree/main/samples/ITI-43_response_raw.xml rel="external nofollow noopener" target=_blank>here</a>.</p> <p>The SOAP <em>Header</em> element of the response conveys the following information:</p> <ul> <li><em>Action</em> element: The SOAP action identifier of the response as defined in the IHE ITI Technical Framework.</li> <li><em>RelatesTo</em> element: The <em>messageID</em> of the request (see above). </li> </ul> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>ITI-43_response.xml</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-1-1> 1</a></span>
<span class=normal><a href=#__codelineno-1-2> 2</a></span>
<span class=normal><a href=#__codelineno-1-3> 3</a></span>
<span class=normal><a href=#__codelineno-1-4> 4</a></span>
<span class=normal><a href=#__codelineno-1-5> 5</a></span>
<span class=normal><a href=#__codelineno-1-6> 6</a></span>
<span class=normal><a href=#__codelineno-1-7> 7</a></span>
<span class=normal><a href=#__codelineno-1-8> 8</a></span>
<span class=normal><a href=#__codelineno-1-9> 9</a></span>
<span class=normal><a href=#__codelineno-1-10>10</a></span>
<span class=normal><a href=#__codelineno-1-11>11</a></span>
<span class=normal><a href=#__codelineno-1-12>12</a></span>
<span class=normal><a href=#__codelineno-1-13>13</a></span>
<span class=normal><a href=#__codelineno-1-14>14</a></span>
<span class=normal><a href=#__codelineno-1-15>15</a></span>
<span class=normal><a href=#__codelineno-1-16>16</a></span>
<span class=normal><a href=#__codelineno-1-17>17</a></span>
<span class=normal><a href=#__codelineno-1-18>18</a></span>
<span class=normal><a href=#__codelineno-1-19>19</a></span>
<span class=normal><a href=#__codelineno-1-20>20</a></span>
<span class=normal><a href=#__codelineno-1-21>21</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1></a><span class=cp>&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39;?&gt;</span>
<a id=__codelineno-1-2 name=__codelineno-1-2></a><span class=nt>&lt;soapenv:Envelope</span><span class=w> </span><span class=na>xmlns:soapenv=</span><span class=s>&quot;http://www.w3.org/2003/05/soap-envelope&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-1-3 name=__codelineno-1-3></a><span class=w>  </span><span class=nt>&lt;soapenv:Header</span><span class=w> </span><span class=na>xmlns:wsa=</span><span class=s>&quot;http://www.w3.org/2005/08/addressing&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-1-4 name=__codelineno-1-4></a><span class=w>    </span><span class=nt>&lt;wsa:Action&gt;</span>urn:ihe:iti:2007:RetrieveDocumentSetResponse<span class=nt>&lt;/wsa:Action&gt;</span>
<a id=__codelineno-1-5 name=__codelineno-1-5></a><span class=w>    </span><span class=nt>&lt;wsa:RelatesTo&gt;</span>urn:uuid:1EB10F67-6562-46D5-9B6B-5DC42EB2B4A6<span class=nt>&lt;/wsa:RelatesTo&gt;</span>
<a id=__codelineno-1-6 name=__codelineno-1-6></a><span class=w>  </span><span class=nt>&lt;/soapenv:Header&gt;</span>
<a id=__codelineno-1-7 name=__codelineno-1-7></a><span class=w>  </span><span class=nt>&lt;soapenv:Body&gt;</span>
<a id=__codelineno-1-8 name=__codelineno-1-8></a><span class=w>    </span><span class=nt>&lt;ns3:RetrieveDocumentSetResponse</span><span class=w> </span><span class=na>xmlns=</span><span class=s>&quot; !-- namespaces omitted -- &quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-1-9 name=__codelineno-1-9></a><span class=w>      </span><span class=nt>&lt;ns6:RegistryResponse</span><span class=w> </span><span class=na>status=</span><span class=s>&quot;urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Success&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-1-10 name=__codelineno-1-10></a><span class=w>      </span><span class=nt>&lt;ns3:DocumentResponse&gt;</span>
<a id=__codelineno-1-11 name=__codelineno-1-11></a><span class=w>        </span><span class=nt>&lt;ns3:HomeCommunityId&gt;</span>urn:oid:1.3.6.1.4.1.21367.2017.2.6.19<span class=nt>&lt;/ns3:HomeCommunityId&gt;</span>
<a id=__codelineno-1-12 name=__codelineno-1-12></a><span class=w>        </span><span class=nt>&lt;ns3:RepositoryUniqueId&gt;</span>1.3.6.1.4.1.21367.2017.2.3.54<span class=nt>&lt;/ns3:RepositoryUniqueId&gt;</span>
<a id=__codelineno-1-13 name=__codelineno-1-13></a><span class=w>        </span><span class=nt>&lt;ns3:DocumentUniqueId&gt;</span>1.3.6.1.4.1.21367.2017.2.1.75.20200922130227623<span class=nt>&lt;/ns3:DocumentUniqueId&gt;</span>
<a id=__codelineno-1-14 name=__codelineno-1-14></a><span class=w>        </span><span class=nt>&lt;ns3:mimeType&gt;</span>application/pdf<span class=nt>&lt;/ns3:mimeType&gt;</span>
<a id=__codelineno-1-15 name=__codelineno-1-15></a><span class=w>        </span><span class=nt>&lt;ns3:Document</span><span class=w> </span><span class=na>xmlns:xop=</span><span class=s>&quot;http://www.w3.org/2004/08/xop/include&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-1-16 name=__codelineno-1-16></a><span class=w>          </span><span class=nt>&lt;xop:Include</span><span class=w> </span><span class=na>href=</span><span class=s>&quot;cid:72f7c587daaacb8b81212de4e80e442e5f43394482e12edd@apache.org&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-1-17 name=__codelineno-1-17></a><span class=w>        </span><span class=nt>&lt;/ns3:Document&gt;</span>
<a id=__codelineno-1-18 name=__codelineno-1-18></a><span class=w>      </span><span class=nt>&lt;/ns3:DocumentResponse&gt;</span>
<a id=__codelineno-1-19 name=__codelineno-1-19></a><span class=w>    </span><span class=nt>&lt;/ns3:RetrieveDocumentSetResponse&gt;</span>
<a id=__codelineno-1-20 name=__codelineno-1-20></a><span class=w>  </span><span class=nt>&lt;/soapenv:Body&gt;</span>
<a id=__codelineno-1-21 name=__codelineno-1-21></a><span class=nt>&lt;/soapenv:Envelope&gt;</span>
</code></pre></div></td></tr></table></div> <p>The SOAP <em>Body</em> element conveys the ebXML <em>RetrieveDocumentSetResponse</em> which conveys 1..N <em>DocumentResponse</em> elements (lines 9 to 17 below) with the following information:</p> <ul> <li><em>HomeCommunityId</em> : Unique ID of the community.</li> <li><em>RepositoryUniqueId</em>: Unique ID of repository.</li> <li><em>DocumentUniqueId</em>: Unique ID of the document.</li> <li><em>Document</em> element (line 14 to 16): It's <em>Include</em> element conveys the <em>content-id</em> reference of the attached document in the MTOM response (see below).</li> </ul> <h3 id=transport-protocol>Transport Protocol<a class=headerlink href=#transport-protocol title="Permanent link"> ¶</a></h3> <p>The system shall send the request messages to the repository service of the community using the MIME Multipart/Related binding as specified in the SOAP <a href=https://www.w3.org/TR/soap12-mtom/ rel="external nofollow noopener" target=_blank>MTOM specification</a> of the W3C.</p> <p>The repository responds the documents using the MIME Multipart/Related binding as specified in the SOAP <a href=https://www.w3.org/TR/soap12-mtom/ rel="external nofollow noopener" target=_blank>MTOM specification</a> of the W3C. A full message may look like:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-2-1> 1</a></span>
<span class=normal><a href=#__codelineno-2-2> 2</a></span>
<span class=normal><a href=#__codelineno-2-3> 3</a></span>
<span class=normal><a href=#__codelineno-2-4> 4</a></span>
<span class=normal><a href=#__codelineno-2-5> 5</a></span>
<span class=normal><a href=#__codelineno-2-6> 6</a></span>
<span class=normal><a href=#__codelineno-2-7> 7</a></span>
<span class=normal><a href=#__codelineno-2-8> 8</a></span>
<span class=normal><a href=#__codelineno-2-9> 9</a></span>
<span class=normal><a href=#__codelineno-2-10>10</a></span>
<span class=normal><a href=#__codelineno-2-11>11</a></span>
<span class=normal><a href=#__codelineno-2-12>12</a></span>
<span class=normal><a href=#__codelineno-2-13>13</a></span>
<span class=normal><a href=#__codelineno-2-14>14</a></span>
<span class=normal><a href=#__codelineno-2-15>15</a></span>
<span class=normal><a href=#__codelineno-2-16>16</a></span>
<span class=normal><a href=#__codelineno-2-17>17</a></span>
<span class=normal><a href=#__codelineno-2-18>18</a></span>
<span class=normal><a href=#__codelineno-2-19>19</a></span>
<span class=normal><a href=#__codelineno-2-20>20</a></span>
<span class=normal><a href=#__codelineno-2-21>21</a></span>
<span class=normal><a href=#__codelineno-2-22>22</a></span>
<span class=normal><a href=#__codelineno-2-23>23</a></span>
<span class=normal><a href=#__codelineno-2-24>24</a></span>
<span class=normal><a href=#__codelineno-2-25>25</a></span>
<span class=normal><a href=#__codelineno-2-26>26</a></span>
<span class=normal><a href=#__codelineno-2-27>27</a></span>
<span class=normal><a href=#__codelineno-2-28>28</a></span>
<span class=normal><a href=#__codelineno-2-29>29</a></span>
<span class=normal><a href=#__codelineno-2-30>30</a></span>
<span class=normal><a href=#__codelineno-2-31>31</a></span>
<span class=normal><a href=#__codelineno-2-32>32</a></span>
<span class=normal><a href=#__codelineno-2-33>33</a></span>
<span class=normal><a href=#__codelineno-2-34>34</a></span>
<span class=normal><a href=#__codelineno-2-35>35</a></span>
<span class=normal><a href=#__codelineno-2-36>36</a></span>
<span class=normal><a href=#__codelineno-2-37>37</a></span>
<span class=normal><a href=#__codelineno-2-38>38</a></span>
<span class=normal><a href=#__codelineno-2-39>39</a></span>
<span class=normal><a href=#__codelineno-2-40>40</a></span>
<span class=normal><a href=#__codelineno-2-41>41</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1></a><span class=err>DefaultHttpResponse(chunked: false)</span>
<a id=__codelineno-2-2 name=__codelineno-2-2></a><span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span> <span class=m>200</span> <span class=ne>OK</span>
<a id=__codelineno-2-3 name=__codelineno-2-3></a><span class=na>Connection</span><span class=o>:</span> <span class=l>Keep-Alive</span>
<a id=__codelineno-2-4 name=__codelineno-2-4></a><span class=na>Content-Length</span><span class=o>:</span> <span class=l>nnnn  </span>
<a id=__codelineno-2-5 name=__codelineno-2-5></a><span class=na>Content-Type</span><span class=o>:</span> <span class=l>multipart/related; boundary=MIMEBoundary4A7AE55984E7438034;type=&quot;application/xop+xml&quot;; start=&quot;&lt;0.09BC7F4BE2E4D3EF1B@apache.org&gt;&quot;;start-info=&quot;text/xml; charset=utf-8&quot;</span>
<a id=__codelineno-2-6 name=__codelineno-2-6></a>
<a id=__codelineno-2-7 name=__codelineno-2-7></a><span class=err>--MIMEBoundary4A7AE55984E7438034</span>
<a id=__codelineno-2-8 name=__codelineno-2-8></a><span class=nt>content-type:</span><span class=w> </span><span class=nl>application</span><span class=dl>/</span><span class=nl>xop</span><span class=err>+xml</span>;<span class=w> </span><span class=na>charset</span><span class=o>=</span><span class=s>utf-8</span>;<span class=w> </span><span class=na>type</span><span class=o>=</span><span class=s>&quot;application/soap+xml</span><span class=err>;&quot;</span>
<a id=__codelineno-2-9 name=__codelineno-2-9></a><span class=nt>content-transfer-encoding:</span><span class=w> </span><span class=no>binary</span>
<a id=__codelineno-2-10 name=__codelineno-2-10></a><span class=c>content-id: &lt;0.09BC7F4BE2E4D3EF1B@apache.org&gt;</span>
<a id=__codelineno-2-11 name=__codelineno-2-11></a>
<a id=__codelineno-2-12 name=__codelineno-2-12></a><span class=x>&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39;?&gt;</span>
<a id=__codelineno-2-13 name=__codelineno-2-13></a><span class=x>&lt;soapenv:Envelope xmlns:soapenv=&quot;http://www.w3.org/2003/05/soap-envelope&quot;&gt;</span>
<a id=__codelineno-2-14 name=__codelineno-2-14></a><span class=x>  &lt;soapenv:Header xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot;&gt;</span>
<a id=__codelineno-2-15 name=__codelineno-2-15></a><span class=x>    &lt;wsa:Action&gt;urn:ihe:iti:2007:RetrieveDocumentSetResponse&lt;/wsa:Action&gt;</span>
<a id=__codelineno-2-16 name=__codelineno-2-16></a><span class=x>    &lt;wsa:RelatesTo&gt;urn:uuid:1EB10F67-6562-46D5-9B6B-5DC42EB2B4A6&lt;/wsa:RelatesTo&gt;</span>
<a id=__codelineno-2-17 name=__codelineno-2-17></a><span class=x>  &lt;/soapenv:Header&gt;</span>
<a id=__codelineno-2-18 name=__codelineno-2-18></a><span class=x>  &lt;soapenv:Body&gt;</span>
<a id=__codelineno-2-19 name=__codelineno-2-19></a><span class=x>    &lt;ns3:RetrieveDocumentSetResponse xmlns=&quot; !-- namespaces omitted -- &quot;&gt;</span>
<a id=__codelineno-2-20 name=__codelineno-2-20></a><span class=x>      &lt;ns6:RegistryResponse status=&quot;urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Success&quot;/&gt;</span>
<a id=__codelineno-2-21 name=__codelineno-2-21></a><span class=x>      &lt;ns3:DocumentResponse&gt;</span>
<a id=__codelineno-2-22 name=__codelineno-2-22></a><span class=x>        &lt;ns3:HomeCommunityId&gt;urn:oid:1.3.6.1.4.1.21367.2017.2.6.19&lt;/ns3:HomeCommunityId&gt;</span>
<a id=__codelineno-2-23 name=__codelineno-2-23></a><span class=x>        &lt;ns3:RepositoryUniqueId&gt;1.3.6.1.4.1.21367.2017.2.3.54&lt;/ns3:RepositoryUniqueId&gt;</span>
<a id=__codelineno-2-24 name=__codelineno-2-24></a><span class=x>        &lt;ns3:DocumentUniqueId&gt;1.3.6.1.4.1.21367.2017.2.1.75.20200922130227623&lt;/ns3:DocumentUniqueId&gt;</span>
<a id=__codelineno-2-25 name=__codelineno-2-25></a><span class=x>        &lt;ns3:mimeType&gt;application/pdf&lt;/ns3:mimeType&gt;</span>
<a id=__codelineno-2-26 name=__codelineno-2-26></a><span class=x>        &lt;ns3:Document xmlns:xop=&quot;http://www.w3.org/2004/08/xop/include&quot;&gt;</span>
<a id=__codelineno-2-27 name=__codelineno-2-27></a><span class=x>          &lt;xop:Include href=&quot;cid:72f7c587daaacb8b81212de4e80e442e5f43394482e12edd@apache.org&quot;/&gt;</span>
<a id=__codelineno-2-28 name=__codelineno-2-28></a><span class=x>        &lt;/ns3:Document&gt;</span>
<a id=__codelineno-2-29 name=__codelineno-2-29></a><span class=x>      &lt;/ns3:DocumentResponse&gt;</span>
<a id=__codelineno-2-30 name=__codelineno-2-30></a><span class=x>    &lt;/ns3:RetrieveDocumentSetResponse&gt;</span>
<a id=__codelineno-2-31 name=__codelineno-2-31></a><span class=x>  &lt;/soapenv:Body&gt;</span>
<a id=__codelineno-2-32 name=__codelineno-2-32></a><span class=x>&lt;/soapenv:Envelope&gt;</span>
<a id=__codelineno-2-33 name=__codelineno-2-33></a>
<a id=__codelineno-2-34 name=__codelineno-2-34></a><span class=x>--MIMEBoundary4A7AE55984E7438034</span>
<a id=__codelineno-2-35 name=__codelineno-2-35></a><span class=x>content-type: application/octet-stream</span>
<a id=__codelineno-2-36 name=__codelineno-2-36></a><span class=x>content-transfer-encoding: binary</span>
<a id=__codelineno-2-37 name=__codelineno-2-37></a><span class=x>content-id: &lt;72f7c587daaacb8b81212de4e80e442e5f43394482e12edd@apache.org&gt;</span>
<a id=__codelineno-2-38 name=__codelineno-2-38></a>
<a id=__codelineno-2-39 name=__codelineno-2-39></a><span class=x>!-- Binary Data omitted --</span>
<a id=__codelineno-2-40 name=__codelineno-2-40></a>
<a id=__codelineno-2-41 name=__codelineno-2-41></a><span class=x>--MIMEBoundary4A7AE55984E7438034--</span>
</code></pre></div></td></tr></table></div> <h3 id=audit-log>Audit Log<a class=headerlink href=#audit-log title="Permanent link"> ¶</a></h3> <p>Primary systems shall store syslog messages to the audit record repository of the community using <abbr title="Transport Layer Security">TLS</abbr> transport protocol. The audit message uses XML formatting as specified in <a href=https://tools.ietf.org/html/rfc3881 rel="external nofollow noopener" target=_blank>RFC 3881</a> with restrictions specified in the <a href="https://ehealthsuisse.ihe-europe.net/gss/audit-messages/view.seam?id=706" rel="external nofollow noopener" target=_blank>IHE ITI TF</a> and the <a href=https://www.fedlex.admin.ch/eli/oc/2024/194/de/annexes rel="external nofollow noopener" target=_blank>Extension 1 to Annex5</a> in the ordinances of the Swiss electronic patient record (see Section 1.5 "Requirements on <abbr title="Audit Trail and Node Authentication">ATNA</abbr>"). </p> <p>The following snippet shows a example audit message to be written by the primary system:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>iti-43-log.xml</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-3-1> 1</a></span>
<span class=normal><a href=#__codelineno-3-2> 2</a></span>
<span class=normal><a href=#__codelineno-3-3> 3</a></span>
<span class=normal><a href=#__codelineno-3-4> 4</a></span>
<span class=normal><a href=#__codelineno-3-5> 5</a></span>
<span class=normal><a href=#__codelineno-3-6> 6</a></span>
<span class=normal><a href=#__codelineno-3-7> 7</a></span>
<span class=normal><a href=#__codelineno-3-8> 8</a></span>
<span class=normal><a href=#__codelineno-3-9> 9</a></span>
<span class=normal><a href=#__codelineno-3-10>10</a></span>
<span class=normal><a href=#__codelineno-3-11>11</a></span>
<span class=normal><a href=#__codelineno-3-12>12</a></span>
<span class=normal><a href=#__codelineno-3-13>13</a></span>
<span class=normal><a href=#__codelineno-3-14>14</a></span>
<span class=normal><a href=#__codelineno-3-15>15</a></span>
<span class=normal><a href=#__codelineno-3-16>16</a></span>
<span class=normal><a href=#__codelineno-3-17>17</a></span>
<span class=normal><a href=#__codelineno-3-18>18</a></span>
<span class=normal><a href=#__codelineno-3-19>19</a></span>
<span class=normal><a href=#__codelineno-3-20>20</a></span>
<span class=normal><a href=#__codelineno-3-21>21</a></span>
<span class=normal><a href=#__codelineno-3-22>22</a></span>
<span class=normal><a href=#__codelineno-3-23>23</a></span>
<span class=normal><a href=#__codelineno-3-24>24</a></span>
<span class=normal><a href=#__codelineno-3-25>25</a></span>
<span class=normal><a href=#__codelineno-3-26>26</a></span>
<span class=normal><a href=#__codelineno-3-27>27</a></span>
<span class=normal><a href=#__codelineno-3-28>28</a></span>
<span class=normal><a href=#__codelineno-3-29>29</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1></a><span class=cp>&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39;?&gt;</span>
<a id=__codelineno-3-2 name=__codelineno-3-2></a><span class=nt>&lt;AuditMessage&gt;</span>
<a id=__codelineno-3-3 name=__codelineno-3-3></a><span class=w> </span><span class=nt>&lt;EventIdentification</span><span class=w> </span><span class=na>EventActionCode=</span><span class=s>&quot;C&quot;</span><span class=w> </span><span class=na>EventDateTime=</span><span class=s>&quot;2020-06-04T10:54:39.571Z&quot;</span><span class=w> </span><span class=na>EventOutcomeIndicator=</span><span class=s>&quot;0&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-4 name=__codelineno-3-4></a><span class=w>  </span><span class=nt>&lt;EventID</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;110107&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;DCM&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Import&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-5 name=__codelineno-3-5></a><span class=w>  </span><span class=nt>&lt;EventTypeCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;ITI-43&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;IHE Transactions&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Retrieve Document Set&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-6 name=__codelineno-3-6></a><span class=w>  </span><span class=nt>&lt;PurposeOfUse</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;NORM&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;2.16.756.5.30.1.127.3.10.5&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Normal&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-7 name=__codelineno-3-7></a><span class=w> </span><span class=nt>&lt;/EventIdentification&gt;</span>
<a id=__codelineno-3-8 name=__codelineno-3-8></a><span class=w> </span><span class=nt>&lt;ActiveParticipant</span><span class=w> </span><span class=na>UserID=</span><span class=s>&quot;pma@gnt.com&quot;</span><span class=w> </span><span class=na>UserName=</span><span class=s>&quot;JD&amp;lt;pma@gnt.com&amp;gt;&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-9 name=__codelineno-3-9></a><span class=w> </span><span class=nt>&lt;ActiveParticipant</span><span class=w> </span><span class=na>UserID=</span><span class=s>&quot;2000000090108&quot;</span><span class=w> </span><span class=na>UserName=</span><span class=s>&quot;Dr. med. John Doe&quot;</span><span class=w> </span><span class=na>UserIsRequestor=</span><span class=s>&quot;true&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-10 name=__codelineno-3-10></a><span class=w>  </span><span class=nt>&lt;RoleIDCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;HCP&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;2.16.756.5.30.1.127.3.10.6&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Healthcare professional&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-11 name=__codelineno-3-11></a><span class=w> </span><span class=nt>&lt;/ActiveParticipant&gt;</span>
<a id=__codelineno-3-12 name=__codelineno-3-12></a><span class=w> </span><span class=nt>&lt;ActiveParticipant</span><span class=w> </span><span class=na>UserID=</span><span class=s>&quot;https://repositoryService.com&quot;</span><span class=w> </span><span class=na>AlternativeUserID=</span><span class=s>&quot;1&quot;</span><span class=w> </span><span class=na>UserIsRequestor=</span><span class=s>&quot;false&quot;</span><span class=w> </span><span class=na>NetworkAccessPointID=</span><span class=s>&quot;172.18.0.49&quot;</span><span class=w> </span><span class=na>NetworkAccessPointTypeCode=</span><span class=s>&quot;2&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-13 name=__codelineno-3-13></a><span class=w>  </span><span class=nt>&lt;RoleIDCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;110153&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;DCM&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Source Role ID&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-14 name=__codelineno-3-14></a><span class=w> </span><span class=nt>&lt;/ActiveParticipant&gt;</span>
<a id=__codelineno-3-15 name=__codelineno-3-15></a><span class=w> </span><span class=nt>&lt;ActiveParticipant</span><span class=w> </span><span class=na>UserID=</span><span class=s>&quot;https://primarySystem.com&quot;</span><span class=w> </span><span class=na>AlternativeUserID=</span><span class=s>&quot;UNKNOWN&quot;</span><span class=w> </span><span class=na>UserIsRequestor=</span><span class=s>&quot;true&quot;</span><span class=w> </span><span class=na>NetworkAccessPointID=</span><span class=s>&quot;hcohcdemo01-app06-icwpxs01.net.swisscom-health.it&quot;</span><span class=w> </span><span class=na>NetworkAccessPointTypeCode=</span><span class=s>&quot;1&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-16 name=__codelineno-3-16></a><span class=w>  </span><span class=nt>&lt;RoleIDCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;110152&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;DCM&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Destination Role ID&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-17 name=__codelineno-3-17></a><span class=w> </span><span class=nt>&lt;/ActiveParticipant&gt;</span>
<a id=__codelineno-3-18 name=__codelineno-3-18></a><span class=w> </span><span class=nt>&lt;AuditSourceIdentification</span><span class=w> </span><span class=na>AuditEnterpriseSiteID=</span><span class=s>&quot;2.16.756.5.30.1.194&quot;</span><span class=w> </span><span class=na>AuditSourceID=</span><span class=s>&quot;LE-Portal&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-19 name=__codelineno-3-19></a><span class=w>  </span><span class=nt>&lt;AuditSourceTypeCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;9&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;DCM&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Other&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-20 name=__codelineno-3-20></a><span class=w> </span><span class=nt>&lt;/AuditSourceIdentification&gt;</span>
<a id=__codelineno-3-21 name=__codelineno-3-21></a><span class=w> </span><span class=nt>&lt;ParticipantObjectIdentification</span><span class=w> </span><span class=na>ParticipantObjectID=</span><span class=s>&quot;761337615343338300^^^&amp;amp;2.16.756.5.30.1.127.3.10.3&amp;amp;ISO&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCode=</span><span class=s>&quot;1&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCodeRole=</span><span class=s>&quot;1&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-22 name=__codelineno-3-22></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectIDTypeCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;2&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;RFC-3881&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Patient Number&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-23 name=__codelineno-3-23></a><span class=w> </span><span class=nt>&lt;/ParticipantObjectIdentification&gt;</span>
<a id=__codelineno-3-24 name=__codelineno-3-24></a><span class=w> </span><span class=nt>&lt;ParticipantObjectIdentification</span><span class=w> </span><span class=na>ParticipantObjectID=</span><span class=s>&quot;2.16.756.5.30.1.194.130880.1591258526941&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCode=</span><span class=s>&quot;2&quot;</span><span class=w> </span><span class=na>ParticipantObjectTypeCodeRole=</span><span class=s>&quot;3&quot;</span><span class=nt>&gt;</span>
<a id=__codelineno-3-25 name=__codelineno-3-25></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectIDTypeCode</span><span class=w> </span><span class=na>csd-code=</span><span class=s>&quot;9&quot;</span><span class=w> </span><span class=na>codeSystemName=</span><span class=s>&quot;RFC-3881&quot;</span><span class=w> </span><span class=na>originalText=</span><span class=s>&quot;Report Number&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-26 name=__codelineno-3-26></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectDetail</span><span class=w> </span><span class=na>type=</span><span class=s>&quot;Repository Unique Id&quot;</span><span class=w> </span><span class=na>value=</span><span class=s>&quot;Mi4xNi43NTYuNS4zMC4xLjE5NC4zLjMuMQ==&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-27 name=__codelineno-3-27></a><span class=w>  </span><span class=nt>&lt;ParticipantObjectDetail</span><span class=w> </span><span class=na>type=</span><span class=s>&quot;ihe:homeCommunityID&quot;</span><span class=w> </span><span class=na>value=</span><span class=s>&quot;dXJuOm9pZDoyLjE2Ljc1Ni41LjMwLjEuMTk0&quot;</span><span class=nt>/&gt;</span>
<a id=__codelineno-3-28 name=__codelineno-3-28></a><span class=w> </span><span class=nt>&lt;/ParticipantObjectIdentification&gt;</span>
<a id=__codelineno-3-29 name=__codelineno-3-29></a><span class=nt>&lt;/AuditMessage&gt;</span>
</code></pre></div></td></tr></table></div> <p>The message is made of the following blocks:</p> <ul> <li><em>EventIdentification</em>: Event related information including the timestamp and purpose of use (line 3 .. 7).</li> <li><em>ActiveParticipant</em>: Information related to the primary system performing the query (line 8 .. 10).</li> <li><em>ActiveParticipant</em>: Information on the user initiating the transaction (line 11 .. 13).</li> <li><em>ActiveParticipant</em>: Additional information on the user initiating the transaction (line 14 .. 16).</li> <li><em>ActiveParticipant</em>: Information on the responding service endpoint (line 17 .. 19).</li> <li><em>AuditSourceIdentification</em>: Information related to the primary system performing the query (line 20 .. 22).</li> <li><em>ParticipantObjectIdentification</em>: Additional information on the patient local ID (line 23 .. 25).</li> <li><em>ParticipantObjectIdentification</em>: Request message related information (line 26 .. 30).</li> <li><em>ParticipantObjectIdentification</em>: Information on the patients <abbr title="Electronic Patient Record">EPR</abbr> accessed (line 31 .. 33).</li> </ul> <h3 id=security-requirements>Security Requirements<a class=headerlink href=#security-requirements title="Permanent link"> ¶</a></h3> <p>To ensure privacy the transaction must be secured using https with mutual authentication, with X.509 certificates (extended validation required) and client and server side certificate validation.</p> <p>To enable authorization, the transaction must convey the <abbr title="X-User Assertion">XUA</abbr> Assertion for authorization in the security header of the SOAP envelope. See <a href=../ProvideXAssertion/ >Provide X-User Assertion</a> for the implementation details.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <ul> <li>Some test environments dropped the mutual authentication or <abbr title="Transport Layer Security">TLS</abbr> for testing purposes. Please contact your test system provider on the details.</li> <li>Some test environments may also drop authorization for testing purposes. Please contact your test system provider on the details. </li> </ul> </div> <h2 id=test-opportunity>Test Opportunity<a class=headerlink href=#test-opportunity title="Permanent link"> ¶</a></h2> <p>The transaction can be tested with the test suite of the <a href=../gazelle/ ><abbr title="Electronic Patient Record">EPR</abbr> reference environment</a>, test systems of the <abbr title="Electronic Patient Record">EPR</abbr> communities or the <a href=../playground/ ><abbr title="Electronic Patient Record">EPR</abbr> Playground</a>.</p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2025-01-27T09:58:37+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-01-27</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> <a href=https://www.e-health-suisse.ch/ >eHealth Suisse</a> | <a href=https://github.com/ehealthsuisse/EPR-by-example/blob/main/LICENSE><em>Creative Commons Zero v1.0 Universal</em></a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.copy", "search.suggest", "search.highlight", "navigation.sections", "navigation.expand", "toc.follow"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.cd18aaf1.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> </body> </html>